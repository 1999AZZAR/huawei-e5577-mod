var g_postfix=window.location.search,MACRO_PUK_UNLOCK_OPERATE=4,send_request={OperateType:MACRO_PUK_UNLOCK_OPERATE,CurrentPin:"",NewPin:"",PukCode:""},g_pukcode_flag=!1,g_newpin_flag=!1,g_retypenewpin_flag=!1;function main_beforeready(){if(null!=g_postfix){var e=g_postfix.length,n=g_postfix.indexOf("?");g_postfix=checkPageExist(g_PageUrlTree,g_postfix.substring(n+1,e))?g_postfix.substring(n+1,e)+".html":""}else g_postfix="";"1"==g_setup_wizard_page&&"hilink"!=g_Driver_classify&&"1"==g_auto_update_enable&&(HOME_PAGE_URL="quicksetup.html")}function initPage(){button_enable("pukrequired_apply","0"),getAjaxData("api/pin/status",(function(e){var n=xml2object(e);"response"==n.type&&(MACRO_PUK_REQUIRED==n.response.SimState?($("#remain_times").text(n.response.SimPukTimes),1>parseInt(n.response.SimPukTimes,10)?($("#input_puk").attr("disabled","disabled"),$("#input_newpin").attr("disabled","disabled"),$("#input_confirmPin").attr("disabled","disabled"),$("#puk_blocked").show(),$("#puk_blocked").html(dialup_help_puk_locked)):($("#input_puk").removeAttr("disabled"),$("#input_newpin").removeAttr("disabled"),$("#input_confirmPin").removeAttr("disabled"),$("#input_puk").val(""),$("#input_newpin").val(""),$("#input_confirmPin").val(""),$("#input_puk").focus())):redirectOnCondition()||gotoPageWithoutHistory(HOME_PAGE_URL+window.location.search))}),{sync:!0}),enableTabKey()}function pukValidateInput(){$("#puk_error").html(""),$("#newpin_error").html(""),$("#confirmPin_error").html("");var e=$("#input_puk").val(),n=$("#input_newpin").val(),i=$("#input_confirmPin").val(),t=/^[0-9]{4,8}$/;return""==e?($("#puk_error").html(dialup_hint_puk_code_valid_type).attr("class","error_message"),$("#input_puk").focus(),$("#input_puk").val(""),button_enable("pukrequired_apply","0"),!1):/^[0-9]{8}$/.exec(e)?""==n?($("#newpin_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#input_newpin").focus(),$("#input_newpin").val(""),button_enable("pukrequired_apply","0"),!1):t.exec(n)?""==i?($("#confirmPin_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#input_confirmPin").focus(),$("#input_confirmPin").val(""),button_enable("pukrequired_apply","0"),!1):t.exec(i)?n==i||($("#confirmPin_error").html(dialup_hint_confirm_and_new_same).attr("class","error_message"),$("#input_newpin").focus(),$("#input_newpin").val(""),$("#input_confirmPin").val(""),button_enable("pukrequired_apply","0"),!1):($("#confirmPin_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#input_confirmPin").focus(),$("#input_confirmPin").val(""),button_enable("pukrequired_apply","0"),!1):($("#newpin_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#input_newpin").focus(),$("#input_newpin").val(""),button_enable("pukrequired_apply","0"),!1):($("#puk_error").html(dialup_hint_puk_code_valid_type).attr("class","error_message"),$("#input_puk").focus(),$("#input_puk").val(""),button_enable("pukrequired_apply","0"),!1)}function onApply(){if($.each($("input"),(function(){$(this).blur()})),pukValidateInput()){var e=$("#input_puk").val(),n=$("#input_newpin").val();$("#input_confirmPin").val();send_request.PukCode=e,send_request.CurrentPin=n,send_request.NewPin=n;var i=object2xml("request",send_request);button_enable("pukrequired_apply","0"),$("#input_puk").val(""),$("#input_newpin").val(""),$("#input_confirmPin").val(""),saveAjaxData("api/pin/operate",i,(function(e){var n=xml2object(e);isAjaxReturnOK(n)?(showInfoDialog(common_success),redirectOnCondition()||setTimeout((function(){return".html"==g_postfix||""==g_postfix?gotoPageWithoutHistory(HOME_PAGE_URL):gotoPageWithoutHistory(g_postfix),!1}),1500)):(showInfoDialog(puk_code_validate_failed),setTimeout((function(){return initPage(),!1}),1500))}),{enc:!0})}}main_beforeready(),$(document).ready((function(){$("#input_puk").focus(),$("input").bind("keyup change input paste cut keydown",(function(){$("#input_puk").val().length>=4&&$("#input_newpin").val().length>=4&&$("#input_confirmPin").val().length>=4?button_enable("pukrequired_apply","1"):button_enable("pukrequired_apply","0")})),$("#pukrequired_apply").bind("click",(function(){isButtonEnable("pukrequired_apply")&&getLoginStatus(onApply,"pukrequired.html")&&onApply()})),1==g_feature.continue_button?$("#link_login").show():$("#link_login").hide(),initPage(),getLoginStatus(),setLoginStatus("pukrequired.html"),$("#link_login").click((function(){window.location=HOME_PAGE_URL}))}));
