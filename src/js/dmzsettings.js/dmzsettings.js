var g_dmzData,g_dhcpData;function updateDmzRadioStatus(){0==$("[name='dmz_status']:checked").val()?($("#dmz_ip_address").attr("disabled","disabled"),$("#dmz_ip_address").val(g_dmzData.DmzIPAddress)):$("#dmz_ip_address").removeAttr("disabled")}function initPage(){getAjaxData("api/dhcp/settings",(function(a){var e=xml2object(a);"response"==e.type&&(g_dhcpData=e.response)})),getAjaxData("api/security/dmz",(function(a){var e=xml2object(a);"response"==e.type&&(g_dmzData=e.response,$("input[name='dmz_status'][value="+g_dmzData.DmzStatus+"]").attr("checked",!0),$("#dmz_ip_address").val(g_dmzData.DmzIPAddress),updateDmzRadioStatus())}))}function isSameBeforThreeAddrs(a,e){var t=a.split("."),d=e.split(".");for(i=0;i<3;i++)if(Number(t[i])!=Number(d[i]))return!1;return!0}function validateDmz(){var a=$("#dmz_ip_address").val();return 0==isValidIpAddress(a)?(showErrorUnderTextbox("dmz_error",dialup_hint_ip_address_empty),$("#dmz_ip_address").focus(),!1):0==isSameBeforThreeAddrs(a,g_dhcpData.DhcpIPAddress)?(showErrorUnderTextbox("dmz_error",firewall_label_dmz_ip_address_invalid),$("#dmz_ip_address").focus(),!1):0==isBroadcastOrNetworkAddress(a,g_dhcpData.DhcpLanNetmask)?(showErrorUnderTextbox("dmz_error",dialup_hint_ip_address_empty),$("#dmz_ip_address").focus(),!1):a!=g_dhcpData.DhcpIPAddress||(showErrorUnderTextbox("dmz_error",dialup_hint_ip_address_empty),$("#dmz_ip_address").focus(),!1)}function apply(){if(clearAllErrorLabel(),isButtonEnable("apply_button")&&validateDmz()){g_dmzData.DmzStatus=$("[name='dmz_status']:checked").val(),g_dmzData.DmzIPAddress=$("#dmz_ip_address").val();var a=object2xml("request",g_dmzData);button_enable("apply_button","0"),saveAjaxData("api/security/dmz",a,(function(a){var e=xml2object(a);isAjaxReturnOK(e)?showInfoDialog(common_success):(button_enable("apply_button","1"),initPage())}))}}$(document).ready((function(){$("input").bind("change input paste cut keydown",(function(a){MACRO_KEYCODE!=a.keyCode&&button_enable("apply_button","1")})),$("[name='dmz_status']").click((function(){updateDmzRadioStatus()})),button_enable("apply_button","0"),initPage()}));
