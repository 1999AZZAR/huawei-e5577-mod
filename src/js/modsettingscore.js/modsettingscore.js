var modsettings_changed=!1;function getModSettingsData(t,i){$.each(i,(function(e,s){void 0!==s&&($("#tr_"+e).length>0||$("#"+e).length>0)&&($("#tr_"+e).show(),$("#"+e).is("span")?$("#"+e).text(s):$("#"+e).is('input[type="checkbox"]')?$("#"+e).attr("checked","true"==s):$("#"+e).is('input[type="file"]')?i[e]=null:$("#"+e).val(s),$("#"+e).attr("data-"+t,!0),!$("#"+e).is("select")||$("#"+e).find('option[value="'+s+'"]').length>0||""==s||$("#"+e).replaceWith('<input id="'+e+'" data-'+t+'="true" type="text" size="25" value="'+s+'"/>'))}))}function postUserConfig(t,i,e){saveUserConfig(user_config,(function(s,o,n){var a=xml2object($(s));isAjaxReturnOK(a)?(!1!==t&&showInfoDialog(common_success),"function"==typeof e&&e(s,o,n)):(showInfoDialog(common_failed),initPageData()),!0===i&&setTimeout("location.reload(true)",3e3)}))}function setModSettings(t,i){$.each(t,(function(t,e){null!==e&&$.ajax({type:"POST",url:"http://"+location.hostname+":5080/cgi-bin/modsettings.cgi?cmd=set&mod="+t,data:e,processData:!1,success:function(t,e,s){"function"==typeof i&&i(t,e,s)},dataType:"json",async:!1})}))}function applyModSettings(t){$.ajax({type:"GET",url:"http://"+location.hostname+":5080/cgi-bin/modsettings.cgi?cmd=apply",success:function(i,e,s){"function"==typeof t&&t(i,e,s)},dataType:"json",async:!1})}function saveUserConfig(t,i){$.ajax({type:"POST",url:"http://"+location.hostname+":5080/cgi-bin/user_config.cgi?cmd=save_config",data:object2xml("config",t),processData:!1,success:function(t,e,s){"function"==typeof i&&i(t,e,s)},dataType:"xml",async:!1})}$(document).ready((function(){$('[data-modsettings="true"], [data-user_config="true"]').live("change input paste cut keydown blur",(function(t){if(MACRO_KEYCODE!=t.keyCode)if($(this).is("select")&&$($(this).get(0)[$(this).get(0).selectedIndex]).is('[data-other="true"]'))$(this).replaceWith('<input id="'+$(this).attr("id")+'" '+($(this).is('[data-modsettings="true"]')?'data-modsettings="true"':"")+" "+($(this).is('[data-user_config="true"]')?'data-user_config="true"':"")+' type="text" size="25" value="'+modsettings[$(this).attr("id")]+'"/>');else{if($(this).is('[data-modsettings="true"]')&&"focusout"!=t.type){if($(this).is('input[type="checkbox"]'))if(modsettings[$(this).attr("id")]=String($(this).prop("checked")),$(this).is('[data-reboot="false"]'))(s={})[$(this).attr("id")]=modsettings[$(this).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(s,(function(t,i,e){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}));else button_enable("apply_button","1");else if($(this).is('input[type="file"]')){if(void 0!==$(this).prop("files")[0]){var i=new FileReader,e=this;i.onload=function(t){if(modsettings[$(e).attr("id")]=t.target.result.split(",")[1],$(e).is('[data-reboot="false"]')){var i={};i[$(e).attr("id")]=modsettings[$(e).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(i,(function(t,i,e){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}))}else button_enable("apply_button","1")},i.readAsDataURL($(e).prop("files")[0])}}else{var s;if(modsettings[$(this).attr("id")]=$(this).val(),$(this).is('[data-reboot="false"]'))(s={})[$(this).attr("id")]=modsettings[$(this).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(s,(function(t,i,e){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}));else button_enable("apply_button","1")}modsettings_changed=!0}if($(this).is('[data-user_config="true"]')&&($(this).is('input[type="text"]')&&"focusout"==t.type||!$(this).is('input[type="text"]')&&"focusout"!=t.type))if($(this).is('input[type="checkbox"]'))user_config[$(this).attr("id")]=String($(this).prop("checked")),postUserConfig(!$(this).is('[data-modsettings="true"]'),$(this).is('[data-reload="true"]'));else if($(this).is('input[type="file"]')){if(void 0!==$(this).prop("files")[0]){i=new FileReader,e=this;i.onload=function(t){user_config[$(e).attr("id")]=t.target.result.split(",")[1],postUserConfig(!$(e).is('[data-modsettings="true"]'),$(e).is('[data-reload="true"]'))},i.readAsDataURL($(this).prop("files")[0])}}else user_config[$(this).attr("id")]=$(this).val(),postUserConfig(!$(this).is('[data-modsettings="true"]'),$(this).is('[data-reload="true"]'))}}))}));
