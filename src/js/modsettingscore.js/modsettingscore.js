var modsettings_changed=!1;function getModSettingsData(t,i){$.each(i,(function(s,e){void 0!==e&&($("#tr_"+s).length>0||$("#"+s).length>0)&&($("#tr_"+s).show(),$("#"+s).is("span")?$("#"+s).text(e):$("#"+s).is('input[type="checkbox"]')?$("#"+s).attr("checked","true"==e):$("#"+s).is('input[type="file"]')?i[s]=null:$("#"+s).val(e),$("#"+s).attr("data-"+t,!0),!$("#"+s).is("select")||$("#"+s).find('option[value="'+e+'"]').length>0||""==e||$("#"+s).replaceWith('<input id="'+s+'" data-'+t+'="true" type="text" size="25" value="'+e+'"/>'))}))}function postUserConfig(t,i,s){saveUserConfig(user_config,(function(e,o,n){var a=xml2object($(e));isAjaxReturnOK(a)?(!1!==t&&showInfoDialog(common_success),"function"==typeof s&&s(e,o,n)):(showInfoDialog(common_failed),initPageData()),!0===i&&setTimeout("location.reload(true)",3e3)}))}function setModSettings(t,i){$.each(t,(function(t,s){null!==s&&$.ajax({type:"POST",url:"http://"+location.hostname+":5080/cgi-bin/modsettings.cgi?cmd=set&mod="+t,data:s,processData:!1,success:function(t,s,e){"function"==typeof i&&i(t,s,e)},dataType:"json",async:!1})}))}function applyModSettings(t){$.ajax({type:"GET",url:"http://"+location.hostname+":5080/cgi-bin/modsettings.cgi?cmd=apply",success:function(i,s,e){"function"==typeof t&&t(i,s,e)},dataType:"json",async:!1})}function saveUserConfig(t,i){$.ajax({type:"POST",url:"http://"+location.hostname+":5080/cgi-bin/user_config.cgi?cmd=save_config",data:object2xml("config",t),processData:!1,success:function(t,s,e){"function"==typeof i&&i(t,s,e)},dataType:"xml",async:!1})}$(document).ready((function(){$('[data-modsettings="true"], [data-user_config="true"]').live("change input paste cut keydown blur",(function(t){if(MACRO_KEYCODE!=t.keyCode)if($(this).is("select")&&$($(this).get(0)[$(this).get(0).selectedIndex]).is('[data-other="true"]'))$(this).replaceWith('<input id="'+$(this).attr("id")+'" '+($(this).is('[data-modsettings="true"]')?'data-modsettings="true"':"")+" "+($(this).is('[data-user_config="true"]')?'data-user_config="true"':"")+' type="text" size="25" value="'+modsettings[$(this).attr("id")]+'"/>');else{if($(this).is('[data-modsettings="true"]')&&"focusout"!=t.type){if($(this).is('input[type="checkbox"]'))modsettings[$(this).attr("id")]=String($(this).prop("checked")),$(this).is('[data-reboot="false"]')?((e={})[$(this).attr("id")]=modsettings[$(this).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(e,(function(t,i,s){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}))):button_enable("apply_button","1");else if($(this).is('input[type="file"]')){if(void 0!==$(this).prop("files")[0]){var i=new FileReader,s=this;i.onload=function(t){if(modsettings[$(s).attr("id")]=t.target.result.split(",")[1],$(s).is('[data-reboot="false"]')){var i={};i[$(s).attr("id")]=modsettings[$(s).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(i,(function(t,i,s){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}))}else button_enable("apply_button","1")},i.readAsDataURL($(s).prop("files")[0])}}else{var e;modsettings[$(this).attr("id")]=$(this).val(),$(this).is('[data-reboot="false"]')?((e={})[$(this).attr("id")]=modsettings[$(this).attr("id")],showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments,(function(){})),setModSettings(e,(function(t,i,s){closeWaitingDialog(),isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed)}))):button_enable("apply_button","1")}modsettings_changed=!0}$(this).is('[data-user_config="true"]')&&($(this).is('input[type="text"]')&&"focusout"==t.type||!$(this).is('input[type="text"]')&&"focusout"!=t.type)&&($(this).is('input[type="checkbox"]')?(user_config[$(this).attr("id")]=String($(this).prop("checked")),postUserConfig(!$(this).is('[data-modsettings="true"]'),$(this).is('[data-reload="true"]'))):$(this).is('input[type="file"]')?void 0!==$(this).prop("files")[0]&&(i=new FileReader,s=this,i.onload=function(t){user_config[$(s).attr("id")]=t.target.result.split(",")[1],postUserConfig(!$(s).is('[data-modsettings="true"]'),$(s).is('[data-reload="true"]'))},i.readAsDataURL($(this).prop("files")[0])):(user_config[$(this).attr("id")]=$(this).val(),postUserConfig(!$(this).is('[data-modsettings="true"]'),$(this).is('[data-reload="true"]'))))}}))}));
