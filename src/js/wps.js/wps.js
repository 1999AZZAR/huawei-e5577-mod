var infomsg="<table cellpadding='0' align='center' cellspacing='0'><tr height='32'><td width='400' colspan='2'>"+IDS_wlan_message_n_mode_forbidden_wps+"</td></tr><tr><td colspan='2'><hr/></td></tr><tr><td width='200' class = 'wps_forbidden_message'>"+wlan_label_wlan_module+common_colon+"</td><td width='200' class = 'wps_forbidden_message'>"+common_disable+"</td></tr><tr><td width='200' class = 'wps_forbidden_message'>"+IDS_wlan_label_80211_authentication+common_colon+" </td><td width='200' class = 'wps_forbidden_message' id = 'wps_forbidden'> </td ></tr><tr><td width='200' class = 'wps_forbidden_message'>"+wlan_label_ssid_broadcast+common_colon+"</td><td width='200' class = 'wps_forbidden_message'>"+common_disable+"</td></tr></table>",cancelWaiting="<tr><td><div class='cancel_waitDIV'><span class='button_wrapper wait_Cancel'><input id='pop_Cancel' class='button_dialog' type='button' value='"+common_cancel+"'/></span></div></td></tr>",WPS_NOTICE_TIME=2e4,mainssid2="",g_wps_dataVlaue="",defult_wpsAp=null,WPS_VERIFY_PIN_1=1,WPS_VERIFY_PIN_3=3,PBC_CONNECT_FAILED="0",PBC_CONNECTING="1",PBC_CONNECT_SUCCESS="2",PBC_GET_STATUS_INTERVAL=5e3,PBC_WAITING_TIMEOUT=18e4,pbcGetStatusTimer=null,pbcWaitingTimer=null,DOUBLECHIP=1,g_wlan_secInfo_ex=[],g_wps_flag=!1,g_wps_flag_2g=!1,g_wps_flag_5g=!1,defult_pincode="",IDS_wlan_fre_0="2.4GHz",IDS_wlan_fre_1="5GHz",g_wlan_Data=[],g_wlanStatus=!0,g_wlanStatus_5g=!0,g_wps_basicData=[],g_security_modewep=1,g_wpspin=0,g_wpspbc=0,g_wpsappin=0,WPS_CONNECTSUCCEED=117005,g_wps_config="",g_wps_securityData_old=[];function getDAesString(e,t,a){return t=CryptoJS.enc.Hex.parse(t),a=CryptoJS.enc.Hex.parse(a),CryptoJS.AES.decrypt(e,t,{iv:a,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Latin1)}function getDeviceConfig(){getConfigData("config/wifi/configure.xml",(function(e){var t=_xml2feature(e);"undefined"!==t&&null!==t&&(0==(g_wps_config=t.wifiwps.wpspinpbc)?(g_wpspin=1,g_wpspbc=0,g_wpsappin=0):1==g_wps_config?(g_wpspin=1,g_wpspbc=1,g_wpsappin=0):2==g_wps_config?(g_wpspin=0,g_wpspbc=1,g_wpsappin=0):3==g_wps_config?(g_wpspin=0,g_wpspbc=0,g_wpsappin=1):4==g_wps_config?(g_wpspin=1,g_wpspbc=0,g_wpsappin=1):5==g_wps_config?(g_wpspin=1,g_wpspbc=1,g_wpsappin=1):6==g_wps_config&&(g_wpspin=0,g_wpspbc=1,g_wpsappin=1))}),{sync:!0}),null!=g_wifiFeatureSwitch&&DOUBLECHIP==g_wifiFeatureSwitch.isdoublechip&&getAjaxData("api/wlan/multi-security-settings-ex",(function(e){var t=xml2object(e).response.ssids.ssid;if(g_wlan_Data=CreateArray(t),g_wlanStatus="1"==g_wlan_Data[0].WifiEnable,null!=g_wifiFeatureSwitch&&2==g_wifiFeatureSwitch.maxapnum)getAjaxData("api/wlan/multi-switch-settings",(function(e){var t=xml2object(e);"response"==t.type&&(g_wlan_multiSsidStatus=t.response,g_wlanStatus_5g="1"==g_wlan_multiSsidStatus.multissidstatus)}),{sync:!0});else{var a=0;for(a=0;a<g_wlan_Data.length;a++)if("a/n/ac"==g_wlan_Data[a].WifiMode||"a/n"==g_wlan_Data[a].WifiMode||"a"==g_wlan_Data[a].WifiMode){g_wlanStatus_5g="1"==g_wlan_Data[a].WifiEnable;break}}}),{sync:!0})}function showErrorDialog(){"1"==g_wifiFeatureSwitch.opennonewps_enable?(showInfoDialog(infomsg,WPS_NOTICE_TIME),button_enable("apply_button","0"),$("#wps_forbidden").html(wlan_label_wep),g_security_modewep=0):(showInfoDialog(infomsg,WPS_NOTICE_TIME),button_enable("apply_button","0"),$("#wps_forbidden").html(IDS_wlan_label_open+"/"+wlan_label_wep),g_security_modewep=0)}function wps_singleSSID_getConfig(){getAjaxData("api/wlan/basic-settings",(function(e){var t=xml2object(e);if(0==t.response.WifiEnable||1==t.response.WifiHide)return null!=g_wifiFeatureSwitch&&"1"==g_wifiFeatureSwitch.opennonewps_enable?(setTimeout((function(){button_enable("apply_button","0"),showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0)):(setTimeout((function(){button_enable("apply_button","0"),showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(IDS_wlan_label_open+"/"+wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0));getAjaxData("api/wlan/security-settings",(function(e){var t=xml2object(e);if(g_wps_securityData_old=t.response,1==g_scarm_login){var a=CryptoJS.SCRAM(),i=a.nonce().toString(),n=a.nonce().toString(),s=doRSAEncrypt(i+n),_=object2xml("request",{module:"wlan",nonce:s});saveAjaxData("api/user/pwd",_,(function(e){var t=xml2object(e);if("response"==t.type){var s=t.response.pwd,_=CryptoJS.enc.Hex.parse(n),p=t.response.iter,o=a.saltedPassword(i,_,p),l=(o=o.toString()).substring(0,32),c=o.substring(32,48),r=o.substring(48,64),b=a.signature(CryptoJS.enc.Hex.parse(s),CryptoJS.enc.Hex.parse(r));if(b=b.toString(),t.response.hash==b){var w,u=getDAesString(CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(s)),l,c);"string"==typeof(u=XSS_UnescapesSpecialChar(u.substring(u.indexOf("<response>"))))||"number"==typeof u?window.ActiveXObject?((w=new ActiveXObject("Microsoft.XMLDOM")).async=!1,w.loadXML(u)):w=(new DOMParser).parseFromString(u,"text/xml"):w=u;var g=xml2object($(w));if("response"==g.type){var d=g.response.Ssids.Ssid;g_wps_securityData_old.WifiWpapsk=d.WifiWpapsk,g_wps_securityData_old.WifiWepKey1=d.WifiWepKey1,g_wps_securityData_old.WifiWepKey2=d.WifiWepKey2,g_wps_securityData_old.WifiWepKey3=d.WifiWepKey3,g_wps_securityData_old.WifiWepKey4=d.WifiWepKey4}}}}),{sync:!0})}if(null!=g_wifiFeatureSwitch&&"1"==g_wifiFeatureSwitch.opennonewps_enable){if("AUTO"==t.response.WifiAuthmode||"OPEN"==t.response.WifiAuthmode&&"WEP"==t.response.WifiBasicencryptionmodes||"SHARE"==t.response.WifiAuthmode)return setTimeout((function(){button_enable("apply_button","0"),showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0);button_enable("apply_button","1")}else if("AUTO"==t.response.WifiAuthmode||"OPEN"==t.response.WifiAuthmode||"SHARE"==t.response.WifiAuthmode)return setTimeout((function(){button_enable("apply_button","0"),showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(IDS_wlan_label_open+"/"+wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0)}))}),{sync:!0},{sync:!0})}function wps_multiSSID_getConfig(){getAjaxData("api/wlan/multi-security-settings",(function(e){if(0==xml2object(e).response.WifiEnable)return null!=g_wifiFeatureSwitch&&"1"==g_wifiFeatureSwitch.opennonewps_enable?(button_enable("apply_button","0"),setTimeout((function(){showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0)):(button_enable("apply_button","0"),setTimeout((function(){showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(IDS_wlan_label_open+"/"+wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0));getAjaxData("api/wlan/multi-basic-settings",(function(e){var t=xml2object(e);if(g_wps_basicData=CreateArray(t.response.Ssids.Ssid),1==g_scarm_login){var a=CryptoJS.SCRAM(),i=a.nonce().toString(),n=a.nonce().toString(),s=doRSAEncrypt(i+n),_=object2xml("request",{module:"wlan",nonce:s});saveAjaxData("api/user/pwd",_,(function(e){var t=xml2object(e);if("response"==t.type){var s=t.response.pwd,_=CryptoJS.enc.Hex.parse(n),p=t.response.iter,o=a.saltedPassword(i,_,p),l=(o=o.toString()).substring(0,32),c=o.substring(32,48),r=o.substring(48,64),b=a.signature(CryptoJS.enc.Hex.parse(s),CryptoJS.enc.Hex.parse(r));if(b=b.toString(),t.response.hash==b){var w,u=getDAesString(CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(s)),l,c);"string"==typeof(u=XSS_UnescapesSpecialChar(u.substring(u.indexOf("<response>"))))||"number"==typeof u?window.ActiveXObject?((w=new ActiveXObject("Microsoft.XMLDOM")).async=!1,w.loadXML(u)):w=(new DOMParser).parseFromString(u,"text/xml"):w=u;var g=xml2object($(w));if("response"==g.type){var d=g.response.Ssids.Ssid,f=CreateArray(d);$(g_wps_basicData).each((function(e){g_wps_basicData[e].WifiWpapsk=f[e].WifiWpapsk,g_wps_basicData[e].MixWifiWpapsk=f[e].MixWifiWpapsk,g_wps_basicData[e].WifiWepKey1=f[e].WifiWepKey1,g_wps_basicData[e].WifiWepKey2=f[e].WifiWepKey2,g_wps_basicData[e].WifiWepKey3=f[e].WifiWepKey3,g_wps_basicData[e].WifiWepKey4=f[e].WifiWepKey4}))}}}}),{sync:!0})}if(null!=g_wifiFeatureSwitch&&(1==g_wifiFeatureSwitch.wps_switch_enable&&"0"==g_wps_basicData[0].WifiWpsenbl?($("#appindisable").attr("checked",!0),$("input:not(#appinenable,#appindisable)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0),button_enable("apply_button","0")):1==g_wifiFeatureSwitch.wps_switch_enable&&"1"==g_wps_basicData[0].WifiWpsenbl&&$("#appinenable").attr("checked",!0)),null!=g_wifiFeatureSwitch&&"1"==g_wifiFeatureSwitch.opennonewps_enable){if("AUTO"==g_wps_basicData[0].WifiAuthmode||"OPEN"==g_wps_basicData[0].WifiAuthmode&&"WEP"==g_wps_basicData[0].WifiBasicencryptionmodes||"SHARE"==g_wps_basicData[0].WifiAuthmode||1!=g_wps_basicData[0].WifiEnable||0!=g_wps_basicData[0].WifiBroadcast)return button_enable("apply_button","0"),setTimeout((function(){showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0)}else if("AUTO"==g_wps_basicData[0].WifiAuthmode||"OPEN"==g_wps_basicData[0].WifiAuthmode||"SHARE"==g_wps_basicData[0].WifiAuthmode||1!=g_wps_basicData[0].WifiEnable||0!=g_wps_basicData[0].WifiBroadcast)return button_enable("apply_button","0"),setTimeout((function(){showInfoDialog(infomsg,WPS_NOTICE_TIME),$("#wps_forbidden").html(IDS_wlan_label_open+"/"+wlan_label_wep)}),500),g_security_modewep=0,$("input:not(#lang)").attr("disabled",!0),void $("select:not(#lang)").attr("disabled",!0)}),{sync:!0})}),{sync:!0})}function wps_multiSSID_getConfig_ex(){getAjaxData("api/wlan/multi-basic-settings",(function(e){var t=xml2object(e);if(g_wps_basicData=CreateArray(t.response.Ssids.Ssid),1==g_scarm_login){var a=CryptoJS.SCRAM(),i=a.nonce().toString(),n=a.nonce().toString(),s=doRSAEncrypt(i+n),_=object2xml("request",{module:"wlan",nonce:s});saveAjaxData("api/user/pwd",_,(function(e){var t=xml2object(e);if("response"==t.type){var s=t.response.pwd,_=CryptoJS.enc.Hex.parse(n),p=t.response.iter,o=a.saltedPassword(i,_,p),l=(o=o.toString()).substring(0,32),c=o.substring(32,48),r=o.substring(48,64),b=a.signature(CryptoJS.enc.Hex.parse(s),CryptoJS.enc.Hex.parse(r));if(b=b.toString(),t.response.hash==b){var w,u=getDAesString(CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(s)),l,c);"string"==typeof(u=XSS_UnescapesSpecialChar(u.substring(u.indexOf("<response>"))))||"number"==typeof u?window.ActiveXObject?((w=new ActiveXObject("Microsoft.XMLDOM")).async=!1,w.loadXML(u)):w=(new DOMParser).parseFromString(u,"text/xml"):w=u;var g=xml2object($(w));if("response"==g.type){temp=g.response.Ssids.Ssid;var d=CreateArray(temp);$(g_wps_basicData).each((function(e){g_wps_basicData[e].WifiWpapsk=d[e].WifiWpapsk,g_wps_basicData[e].MixWifiWpapsk=d[e].MixWifiWpapsk,g_wps_basicData[e].WifiWepKey1=d[e].WifiWepKey1,g_wps_basicData[e].WifiWepKey2=d[e].WifiWepKey2,g_wps_basicData[e].WifiWepKey3=d[e].WifiWepKey3,g_wps_basicData[e].WifiWepKey4=d[e].WifiWepKey4}))}}}}),{sync:!0})}g_wps_basicData.length,mainssid2=g_wps_basicData.length/2,g_wlanStatus&&0==g_wps_basicData[0].WifiBroadcast||g_wlanStatus_5g&&0==g_wps_basicData[mainssid2].WifiBroadcast||(button_enable("apply_button","0"),g_security_modewep=0,showInfoDialog(infomsg,WPS_NOTICE_TIME),$("input:not(#lang)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0)),null!=g_wifiFeatureSwitch&&"1"==g_wifiFeatureSwitch.opennonewps_enable?(1==g_wps_basicData[0].WifiEnable&&0==g_wps_basicData[0].WifiBroadcast&&("WPA2-PSK"==g_wps_basicData[0].WifiAuthmode||"WPA/WPA2-PSK"==g_wps_basicData[0].WifiAuthmode||"OPEN"==g_wps_basicData[0].WifiAuthmode&&"NONE"==g_wps_basicData[0].WifiBasicencryptionmodes)&&(g_wps_flag_2g=!0),1==g_wlanStatus_5g&&0==g_wps_basicData[mainssid2].WifiBroadcast&&("WPA2-PSK"==g_wps_basicData[mainssid2].WifiAuthmode||"WPA/WPA2-PSK"==g_wps_basicData[mainssid2].WifiAuthmode||"OPEN"==g_wps_basicData[mainssid2].WifiAuthmode&&"NONE"==g_wps_basicData[mainssid2].WifiBasicencryptionmodes)&&(g_wps_flag_5g=!0)):(1!=g_wps_basicData[0].WifiEnable||0!=g_wps_basicData[0].WifiBroadcast||"WPA2-PSK"!=g_wps_basicData[0].WifiAuthmode&&"WPA/WPA2-PSK"!=g_wps_basicData[0].WifiAuthmode||(g_wps_flag_2g=!0),1!=g_wlanStatus_5g||0!=g_wps_basicData[mainssid2].WifiBroadcast||"WPA2-PSK"!=g_wps_basicData[mainssid2].WifiAuthmode&&"WPA/WPA2-PSK"!=g_wps_basicData[mainssid2].WifiAuthmode||(g_wps_flag_5g=!0)),g_wps_flag_2g||3==g_wps_config||(button_enable("apply_button","0"),$("input[name=connect_mode]").attr("disabled",!0),$("#input_WPSPin").attr("disabled",!0),showErrorDialog()),g_wps_flag_2g||g_wps_flag_5g?g_wps_flag=!0:(showErrorDialog(),$("input:not(#lang)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0)),1==g_wifiFeatureSwitch.wps_switch_enable&&"0"==g_wps_basicData[0].WifiWpsenbl?($("#appindisable").attr("checked",!0),$("input:not(#appinenable,#appindisable)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0),button_enable("apply_button","0")):1==g_wifiFeatureSwitch.wps_switch_enable&&"1"==g_wps_basicData[0].WifiWpsenbl&&$("#appinenable").attr("checked",!0)}),{sync:!0})}function wps_initPage(){null!=g_wifiFeatureSwitch&&DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip?(1==g_wifiFeatureSwitch.wps_switch_enable?$(".appin_off_no").show():$(".appin_off_no").hide(),1==g_wpsappin?$(".appin_show").show():0==g_wpsappin&&$(".appin_show").hide(),1==g_wpspin&&0==g_wpspbc?($(".pbc_pin").show(),$(".pbc_block").hide(),$(".pbc_show").hide(),$(".pin_show").show(),$("#pin_mode").attr("checked",!0)):0==g_wpspin&&1==g_wpspbc?($(".pbc_pin").show(),$(".pin_block").hide(),$("#pbc_mode").attr("checked",!0),$(".pbc_show").show(),$(".pin_show").hide()):1==g_wpspin&&1==g_wpspbc?($(".pbc_pin").show(),$("#pin_mode").attr("checked",!0),$(".pbc_show").hide(),$(".pin_show").show()):$(".pbc_pin").hide(),$(".work_frequency").hide(),wps_multiSSID_getConfig(),getAjaxData("api/wlan/wps",(function(e){var t=xml2object(e);"response"==t.type&&(g_wps_dataVlaue=t.response,defult_pincode=g_wps_dataVlaue.WPSPin)}),{sync:!0}),1==g_wpsappin&&wpsget_initappin()):(1==g_wifiFeatureSwitch.wps_switch_enable?$(".appin_off_no").show():$(".appin_off_no").hide(),$("#select_frequency option").remove(),$("#select_frequency").append("<option value='0'>"+IDS_wlan_fre_0+"</option>"),$("#select_frequency").append("<option value='1'>"+IDS_wlan_fre_1+"</option>"),1==g_wpsappin?$(".appin_show").show():0==g_wpsappin&&$(".appin_show").hide(),1==g_wpspin&&0==g_wpspbc?($(".pbc_pin").show(),$(".pbc_block").hide(),$(".work_frequency").show(),$(".pbc_show").hide(),$(".pin_show").show(),$("#pin_mode").attr("checked",!0)):0==g_wpspin&&1==g_wpspbc?($(".pbc_pin").show(),$(".pin_block").hide(),$(".work_frequency").show(),$("#pbc_mode").attr("checked",!0),$(".pbc_show").show(),$(".pin_show").hide()):1==g_wpspin&&1==g_wpspbc?($(".pbc_pin").show(),$(".work_frequency").show(),$("#pin_mode").attr("checked",!0),$(".pbc_show").hide(),$(".pin_show").show()):$(".pbc_pin").hide(),wps_multiSSID_getConfig_ex(),getAjaxData("api/wlan/wps",(function(e){var t=xml2object(e);"response"==t.type&&(g_wps_dataVlaue=t.response,defult_pincode=g_wps_dataVlaue.WPSPin)}),{sync:!0}),1==g_wpsappin&&wpsget_initappin()),getAjaxData("api/wlan/wps-pbc",(function(e){var t=xml2object(e);"response"==t.type&&PBC_CONNECTING==t.response.State&&(showWaitingDialog(common_waiting,pbc_label_connecting_network),1==g_wifiFeatureSwitch.wps_cancel_enable&&$("#wait_table tr:last").before(cancelWaiting),pbcWaitingTimer=setTimeout((function(){clearTimeout(pbcGetStatusTimer),closeWaitingDialog(),showInfoDialog(pbc_label_connect_failed)}),PBC_WAITING_TIMEOUT),pbcGetStatusTimer=setTimeout("wps_pbc_connect_status()",PBC_GET_STATUS_INTERVAL))}),{sync:!0})}function wpsget_initappin(){getAjaxData("api/wlan/wps-appin",(function(e){var t=xml2object(e);if("response"==t.type){var a=t.response;defult_wpsAp=a.wpsappin,$(".rand_button").show(),$(".default_button").show(),DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip&&1==g_wps_basicData[0].WifiWpsenbl&&1==g_security_modewep||DOUBLECHIP==g_wifiFeatureSwitch.isdoublechip&&1==g_wps_basicData[0].WifiWpsenbl&&g_wps_flag?($("#wps_appin_code").text(defult_wpsAp),$("#wps_appin_code").fadeIn(3e3),button_enable("default_button","1"),button_enable("rand_button","1")):($("#wps_appin_code").text(common_unknown),button_enable("default_button","0"),button_enable("rand_button","0"))}else"100002"==t.error.code?($(".appin_button").hide(),$(".rand_button").hide(),$(".default_button").hide(),DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip&&1==g_wps_basicData[0].WifiWpsenbl&&1==g_security_modewep||DOUBLECHIP==g_wifiFeatureSwitch.isdoublechip&&1==g_wps_basicData[0].WifiWpsenbl&&g_wps_flag?($("#wps_appin_code").text(""),defult_wpsAp=g_wps_dataVlaue.wpsappin,$("#wps_appin_code").text(defult_wpsAp)):$("#wps_appin_code").text(common_unknown)):($(".rand_button").show(),$(".default_button").show(),$("#wps_appin_code").text(common_unknown),button_enable("default_button","0"),button_enable("rand_button","0"))}),{sync:!0})}function wps_verifyPIN(e){var t=0;return t>>>=0,t+=WPS_VERIFY_PIN_3*(((e>>>=0)/1e7|0)%10),t+=WPS_VERIFY_PIN_1*((e/1e6|0)%10),t+=WPS_VERIFY_PIN_3*((e/1e5|0)%10),t+=WPS_VERIFY_PIN_1*((e/1e4|0)%10),t+=WPS_VERIFY_PIN_3*((e/1e3|0)%10),t+=WPS_VERIFY_PIN_1*((e/100|0)%10),t+=WPS_VERIFY_PIN_3*((e/10|0)%10),0==(t+=WPS_VERIFY_PIN_1*((e/1|0)%10))%10}function wps_validateInput(){var e=$.trim($("#input_WPSPin").val());return""==e||" "==e||null==e?(showErrorUnderTextbox("wps_pin_error",wlan_hint_wps_pin_valid_type),$("#input_WPSPin").focus(),!1):/^[0-9]{4}$|[0-9]{8}$/.exec(e)?!(8==e.length&&!wps_verifyPIN(e=parseInt(e,10))&&(showErrorUnderTextbox("wps_pin_error",IDS_wps_pin_code_verify_error),$("#input_WPSPin").focus().select(),1)):(showErrorUnderTextbox("wps_pin_error",wlan_hint_wps_pin_valid_type),$("#input_WPSPin").focus().select(),!1)}function wps_pin_radio(){$("#input_WPSPin").removeAttr("disabled")}function wps_pbc_radio(){$("#input_WPSPin").attr("disabled","disabled")}function wps_pbc_connect_status(){getAjaxData("api/wlan/wps-pbc",(function(e){var t=xml2object(e);if(PBC_CONNECT_FAILED==t.response.State)clearTimeout(pbcWaitingTimer),closeWaitingDialog(),button_enable("apply_button","1"),showInfoDialog(pbc_label_connect_failed);else{if(PBC_CONNECT_SUCCESS!=t.response.State)return void(pbcGetStatusTimer=setTimeout(wps_pbc_connect_status,PBC_GET_STATUS_INTERVAL));clearTimeout(pbcWaitingTimer),closeWaitingDialog(),button_enable("apply_button","1"),showInfoDialog(pbc_label_connect_success)}}))}function saveWpsPin(){if(wps_validateInput()){DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip?g_wps_dataVlaue.WPSPin=$.trim($("#input_WPSPin").val()):(g_wps_dataVlaue.WPSPin=$.trim($("#input_WPSPin").val()),g_wps_dataVlaue.ssidindex=$.trim($("#select_frequency").val())),g_wps_dataVlaue.WPSPin=$.trim($("#input_WPSPin").val());var e=object2xml("request",g_wps_dataVlaue);clearDialog(),button_enable("apply_button","0"),saveAjaxData("api/wlan/wps",e,(function(e){var t=xml2object(e);isAjaxReturnOK(t)?(showWaitingDialog(common_waiting,pbc_label_connecting_network),1==g_wifiFeatureSwitch.wps_cancel_enable&&$("#wait_table tr:last").before(cancelWaiting),pbcWaitingTimer=setTimeout((function(){clearTimeout(pbcGetStatusTimer),closeWaitingDialog(),showInfoDialog(pbc_label_connect_failed),button_enable("apply_button","1")}),PBC_WAITING_TIMEOUT),pbcGetStatusTimer=setTimeout("wps_pbc_connect_status()",PBC_GET_STATUS_INTERVAL),DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip?$("#input_WPSPin").val($.trim($("#input_WPSPin").val())):($("#input_WPSPin").val($.trim($("#input_WPSPin").val())),$("#select_frequency").val($.trim($("#select_frequency").val())))):(ERROR_SYSTEM_BUSY==t.error.code?showInfoDialog(common_system_busy):showInfoDialog(pbc_label_connect_failed),button_enable("apply_button","1"))}))}}function saveWpsPbc(){if(DOUBLECHIP!=g_wifiFeatureSwitch.isdoublechip)var e={WPSMode:"1"};else e={WPSMode:"1",ssidindex:$.trim($("#select_frequency").val())};var t=object2xml("request",e);clearDialog(),button_enable("apply_button","0"),saveAjaxData("api/wlan/wps-pbc",t,(function(e){var t=xml2object(e);isAjaxReturnOK(t)?(showWaitingDialog(common_waiting,pbc_label_connecting_network),1==g_wifiFeatureSwitch.wps_cancel_enable&&$("#wait_table tr:last").before(cancelWaiting),pbcWaitingTimer=setTimeout((function(){clearTimeout(pbcGetStatusTimer),closeWaitingDialog(),showInfoDialog(pbc_label_connect_failed),button_enable("apply_button","1")}),PBC_WAITING_TIMEOUT),pbcGetStatusTimer=setTimeout("wps_pbc_connect_status()",PBC_GET_STATUS_INTERVAL)):(ERROR_SYSTEM_BUSY==t.error.code?showInfoDialog(common_system_busy):showInfoDialog(pbc_label_connect_failed),button_enable("apply_button","1"))}))}function saveWpsApPin(e){$("#wps_appin_code").fadeOut(1e3);var t=object2xml("request",{wpsappintype:e,wpsappin:defult_wpsAp});saveAjaxData("api/wlan/wps-appin",t,(function(e){var t=xml2object(e);isAjaxReturnOK(t)||(ERROR_SYSTEM_BUSY==t.error.code?showInfoDialog(common_system_busy):showInfoDialog(common_failed)),wpsget_initappin(),$("input[name=radio]").attr("disabled",!1)}))}function saveWpsEnable(e){$.isArray(g_wps_basicData)?$(g_wps_basicData).each((function(t){g_wps_basicData[t].WifiWpsenbl=e,delete g_wps_basicData[t].WifiWpapsk,delete g_wps_basicData[t].MixWifiWpapsk,delete g_wps_basicData[t].WifiWepKey1,delete g_wps_basicData[t].WifiWepKey2,delete g_wps_basicData[t].WifiWepKey3,delete g_wps_basicData[t].WifiWepKey4,delete g_wps_basicData[t].WifiWep128Key1,delete g_wps_basicData[t].WifiWep128Key2,delete g_wps_basicData[t].WifiWep128Key3,delete g_wps_basicData[t].WifiWep128Key4})):(g_wps_basicData.WifiWpsenbl=e,delete g_wps_basicData.WifiWpapsk,delete g_wps_basicData.MixWifiWpapsk,delete g_wps_basicData.WifiWepKey1,delete g_wps_basicData.WifiWepKey2,delete g_wps_basicData.WifiWepKey3,delete g_wps_basicData.WifiWepKey4,delete g_wps_basicData.WifiWep128Key1,delete g_wps_basicData.WifiWep128Key2,delete g_wps_basicData.WifiWep128Key3,delete g_wps_basicData.WifiWep128Key4);var t=object2xml("request",{Ssids:{Ssid:g_wps_basicData},WifiRestart:0});saveAjaxData("api/wlan/multi-basic-settings",t,(function(t){var a=xml2object(t);isAjaxReturnOK(a)&&0==e?$("#wps_appin_code").text(common_unknown):isAjaxReturnOK(a)&&1==e?($("input").attr("disabled",!1),$("select").attr("disabled",!1),button_enable("default_button","1"),button_enable("rand_button","1"),button_enable("apply_button","1"),(DOUBLECHIP==g_wifiFeatureSwitch.isdoublechip&&!g_wps_flag_2g&&0==$("#select_frequency").val()||!g_wps_flag_5g&&1==$("#select_frequency").val())&&(button_enable("apply_button","0"),$("input[name=connect_mode]").attr("disabled",!0),$("#input_WPSPin").attr("disabled",!0)),wpsget_initappin()):(ERROR_SYSTEM_BUSY==a.error.code?showInfoDialog(common_system_busy):showInfoDialog(common_failed),getAjaxData("api/wlan/multi-basic-settings",(function(e){var t=xml2object(e);if(g_wps_basicData=CreateArray(t.response.Ssids.Ssid),1==g_scarm_login){var a=CryptoJS.SCRAM(),i=a.nonce().toString(),n=a.nonce().toString(),s=doRSAEncrypt(i+n),_=object2xml("request",{module:"wlan",nonce:s});saveAjaxData("api/user/pwd",_,(function(e){var t=xml2object(e);if("response"==t.type){var s=t.response.pwd,_=CryptoJS.enc.Hex.parse(n),p=t.response.iter,o=a.saltedPassword(i,_,p),l=(o=o.toString()).substring(0,32),c=o.substring(32,48),r=o.substring(48,64),b=a.signature(CryptoJS.enc.Hex.parse(s),CryptoJS.enc.Hex.parse(r));if(b=b.toString(),t.response.hash==b){var w,u=getDAesString(CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(s)),l,c);"string"==typeof(u=XSS_UnescapesSpecialChar(u.substring(u.indexOf("<response>"))))||"number"==typeof u?window.ActiveXObject?((w=new ActiveXObject("Microsoft.XMLDOM")).async=!1,w.loadXML(u)):w=(new DOMParser).parseFromString(u,"text/xml"):w=u;var g=xml2object($(w));if("response"==g.type){temp=g.response.Ssids.Ssid;var d=CreateArray(temp);$(g_wps_basicData).each((function(e){g_wps_basicData[e].WifiWpapsk=d[e].WifiWpapsk,g_wps_basicData[e].MixWifiWpapsk=d[e].MixWifiWpapsk,g_wps_basicData[e].WifiWepKey1=d[e].WifiWepKey1,g_wps_basicData[e].WifiWepKey2=d[e].WifiWepKey2,g_wps_basicData[e].WifiWepKey3=d[e].WifiWepKey3,g_wps_basicData[e].WifiWepKey4=d[e].WifiWepKey4}))}}}}),{sync:!0})}1==g_wifiFeatureSwitch.wps_switch_enable&&"0"==g_wps_basicData[0].WifiWpsenbl?($("#appindisable").attr("checked",!1),$("input:not(#appinenable,#appindisable)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0),button_enable("default_button","0"),button_enable("rand_button","0"),button_enable("apply_button","0")):1==g_wifiFeatureSwitch.wps_switch_enable&&"1"==g_wps_basicData[0].WifiWpsenbl&&($("#appinenable").attr("checked",!0),button_enable("default_button","1"),button_enable("rand_button","1"),button_enable("apply_button","1"),$("input").attr("disabled",!1),$("select").attr("disabled",!1),(DOUBLECHIP==g_wifiFeatureSwitch.isdoublechip&&!g_wps_flag_2g&&0==$("#select_frequency").val()||!g_wps_flag_5g&&1==$("#select_frequency").val())&&(button_enable("apply_button","0"),$("input[name=connect_mode]").attr("disabled",!0),$("#input_WPSPin").attr("disabled",!0)))})))}))}function wps_apply(){isButtonEnable("apply_button")&&(clearAllErrorLabel(),$("#pin_mode").get(0).checked||1==g_wpspin&&0==g_wpspbc?saveWpsPin():($("#pbc_mode").get(0).checked||0==g_wpspin&&1==g_wpspbc)&&saveWpsPbc())}function rand_wps(){isButtonEnable("rand_button")&&(button_enable("default_button","0"),button_enable("rand_button","0"),$("input[name=radio]").attr("disabled","disabled"),saveWpsApPin(1))}function default_wps(){isButtonEnable("default_button")&&(button_enable("default_button","0"),button_enable("rand_button","0"),$("input[name=radio]").attr("disabled","disabled"),saveWpsApPin(0))}getDeviceConfig(),$(document).ready((function(){button_enable("apply_button","1"),$("input[name=connect_mode]").bind("change",(function(e){clearAllErrorLabel(),$("#pin_mode").get(0).checked?($(".pbc_show").hide(),$(".pin_show").show()):$("#pbc_mode").get(0).checked&&($(".pbc_show").show(),$(".pin_show").hide())})),$("#input_WPSPin").live("click",(function(){$("#pin_mode").attr("checked",!0),$(".pbc_show").hide(),$(".pin_show").show()})),wps_initPage(),$("#select_frequency").live("change",(function(){0==$("#select_frequency").val()&&(g_wps_flag_2g?(button_enable("apply_button","1"),$("input[name=connect_mode]").removeAttr("disabled",!0),$("#input_WPSPin").removeAttr("disabled",!0)):(button_enable("apply_button","0"),$("input[name=connect_mode]").attr("disabled",!0),$("#input_WPSPin").attr("disabled",!0),showErrorDialog())),1==$("#select_frequency").val()&&(g_wps_flag_5g?(button_enable("apply_button","1"),$("input[name=connect_mode]").removeAttr("disabled",!0),$("#input_WPSPin").removeAttr("disabled",!0)):(button_enable("apply_button","0"),$("input[name=connect_mode]").attr("disabled",!0),$("#input_WPSPin").attr("disabled",!0),showErrorDialog()))})),$("input[name=radio]").live("click",(function(){var e="";$("#appinenable").get(0).checked?e=1:(e=0,button_enable("default_button","0"),button_enable("rand_button","0"),button_enable("apply_button","0"),$("input:not(#appinenable,#appindisable)").attr("disabled",!0),$("select:not(#lang)").attr("disabled",!0)),saveWpsEnable(e)})),$("#pop_Cancel").live("click",(function(){if(isButtonEnable("pop_Cancel")){button_enable("pop_Cancel","0");var e=object2xml("request",{cancelwps:"1"});saveAjaxData("api/wlan/wps-cancel",e,(function(e){var t=xml2object(e);isAjaxReturnOK(t),clearTimeout(pbcGetStatusTimer),wps_pbc_connect_status()}))}})),$("#apply_button").live("click",(function(){isButtonEnable("apply_button")&&wps_apply()}))}));
