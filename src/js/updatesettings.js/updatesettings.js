var ForcedUpdate_flat=!1,AutoUpdate_flat=!1,autoUpdateInterval="",auto_update_enable="",server_force_enable="",auto_update="",ui_download="";function postForcedUpdate(e){var t={autoUpdateInterval:autoUpdateInterval,auto_update_enable:auto_update_enable,server_force_enable:""};t.server_force_enable=1==e?1:0;var a=object2xml("request",t);saveAjaxData("api/online-update/configuration",a,(function(e){var t=xml2object(e);isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed),setTimeout((function(){getSwitchStatus()}),g_feature.dialogdisapear)}),{sync:!0})}function postAutoUpdate(e){var t={auto_update:auto_update,ui_download:ui_download};t.auto_update=1==e?1:0;var a=object2xml("request",t);saveAjaxData("api/online-update/autoupdate-config",a,(function(e){var t=xml2object(e);isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed),setTimeout((function(){getSwitchStatus()}),g_feature.dialogdisapear)}),{sync:!0})}function getSwitchStatus(){getAjaxData("api/webserver/white_list_switch",(function(e){var t=xml2object(e);"response"==t.type?($(".notlogin_update_switch :input").removeAttr("disabled"),"1"==t.response.whitelist_enable?$("input[name='notlogin_report']").eq(0).attr("checked",!0):$("input[name='notlogin_report']").eq(1).attr("checked",!0)):"error"==t.type&&($(".notlogin_update_switch :input").attr("disabled","disabled"),$(".notlogin_update_switch").hide())}),{errorCB:function(){$(".notlogin_update_switch :input").attr("disabled","disabled"),$(".notlogin_update_switch").hide()},sync:!0}),getAjaxData("api/online-update/configuration",(function(e){var t=xml2object(e);"response"==t.type?(autoUpdateInterval=t.response.autoUpdateInterval,auto_update_enable=t.response.auto_update_enable,server_force_enable=t.response.server_force_enable,$(".forced_update_switch :input").removeAttr("disabled"),void 0!==t.response.server_force_enable&&"1"==t.response.server_force_enable?(ForcedUpdate_flat=!0,$("input[name='forced_usesreport']").eq(0).attr("checked",!0)):void 0!==t.response.server_force_enable&&"0"==t.response.server_force_enable?(ForcedUpdate_flat=!1,$("input[name='forced_usesreport']").eq(1).attr("checked",!0)):(ForcedUpdate_flat=!1,$(".forced_update_switch :input").attr("disabled","disabled"),$(".forced_update_switch").hide())):"error"==t.type&&(ForcedUpdate_flat=!1,$(".forced_update_switch :input").attr("disabled","disabled"),$(".forced_update_switch").hide())}),{errorCB:function(){ForcedUpdate_flat=!1,$(".forced_update_switch :input").attr("disabled","disabled"),$(".forced_update_switch").hide()},sync:!0}),getAjaxData("api/online-update/autoupdate-config",(function(e){var t=xml2object(e);"response"==t.type?(auto_update=t.response.auto_update,ui_download=t.response.ui_download,$(".auto_update_switch :input").removeAttr("disabled"),void 0!==t.response.auto_update&&"1"==t.response.auto_update?($("input[name='auto_usesreport']").eq(0).attr("checked",!0),AutoUpdate_flat=!0):void 0!==t.response.auto_update&&"0"==t.response.auto_update?($("input[name='auto_usesreport']").eq(1).attr("checked",!0),AutoUpdate_flat=!1):(AutoUpdate_flat=!1,$(".auto_update_switch :input").attr("disabled","disabled"),$(".auto_update_switch").hide())):"error"==t.type&&(AutoUpdate_flat=!1,$(".auto_update_switch :input").attr("disabled","disabled"),$(".auto_update_switch").hide())}),{errorCB:function(){AutoUpdate_flat=!1,$(".auto_update_switch :input").attr("disabled","disabled"),$(".auto_update_switch").hide()},sync:!0})}function setnotloginupdateSwitch(){var e={whitelist_enable:0};e.whitelist_enable=$("[name='notlogin_report']:checked").val();var t=object2xml("request",e);saveAjaxData("api/webserver/white_list_switch",t,(function(e){var t=xml2object(e);isAjaxReturnOK(t)?showInfoDialog(common_success):showInfoDialog(common_failed),setTimeout((function(){getSwitchStatus()}),g_feature.dialogdisapear)}),{sync:!0})}function setforcedupdateSwitch(){var e=$("[name='forced_usesreport']:checked").val();"0"==e&&ForcedUpdate_flat?(force_Update_checkUpdateStatus(),30==force_Update_CurrentComponentStatus?showConfirmDialog(IDS_common_updateSystemConfirmLoading,(function(){postForcedUpdate(0),ForcedUpdate_flat=!1}),(function(){$("input[name='forced_usesreport']").eq(0).attr("checked",!0)}),null,(function(){$("input[name='forced_usesreport']").eq(0).attr("checked",!0)})):14==force_Update_CurrentComponentStatus&&100==force_Update_DownloadProgressStatus?showConfirmDialog(IDS_common_updateSystemConfirmFinish,(function(){postForcedUpdate(0),ForcedUpdate_flat=!1}),(function(){$("input[name='forced_usesreport']").eq(0).attr("checked",!0)}),null,(function(){$("input[name='forced_usesreport']").eq(0).attr("checked",!0)})):(postForcedUpdate(0),ForcedUpdate_flat=!1)):"0"!=e||ForcedUpdate_flat?(postForcedUpdate(1),ForcedUpdate_flat=!0):(postForcedUpdate(0),ForcedUpdate_flat=!1)}function setautoupdateSwitch(){var e=$("[name='auto_usesreport']:checked").val();"0"==e&&AutoUpdate_flat?(force_Update_checkUpdateStatus(),30==force_Update_CurrentComponentStatus?showConfirmDialog(IDS_auto_updateSystemConfirmLoading,(function(){postAutoUpdate(0),AutoUpdate_flat=!1}),(function(){$("input[name='auto_usesreport']").eq(0).attr("checked",!0)}),null,(function(){$("input[name='auto_usesreport']").eq(0).attr("checked",!0)})):14==force_Update_CurrentComponentStatus&&100==force_Update_DownloadProgressStatus?showConfirmDialog(IDS_auto_updateSystemConfirmFinish,(function(){postAutoUpdate(0),AutoUpdate_flat=!1}),(function(){$("input[name='auto_usesreport']").eq(0).attr("checked",!0)}),null,(function(){$("input[name='auto_usesreport']").eq(0).attr("checked",!0)})):(postAutoUpdate(0),AutoUpdate_flat=!1)):"0"!=e||AutoUpdate_flat?(postAutoUpdate(1),AutoUpdate_flat=!0):(postAutoUpdate(0),AutoUpdate_flat=!1)}$(document).ready((function(){getSwitchStatus(),$("input[name='notlogin_report']").bind("change input paste cut keydown",setnotloginupdateSwitch),$("input[name='forced_usesreport']").bind("change input paste cut keydown",setforcedupdateSwitch),$("input[name='auto_usesreport']").bind("change input paste cut keydown",setautoupdateSwitch)}));
