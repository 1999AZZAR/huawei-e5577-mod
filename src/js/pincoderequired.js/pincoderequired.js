var g_postfix=window.location.search,MACRO_PIN_OPERATE_VALIDATE=0,MACRO_PIN_OPERATE_DISABLE=2,PUK_REQUIRED_PAGE="pukrequired.html",g_simSavePinEnnable=0;function main_beforeready(){if(null!=g_postfix){var e=g_postfix.length,i=g_postfix.indexOf("?");g_postfix=checkPageExist(g_PageUrlTree,g_postfix.substring(i+1,e))?g_postfix.substring(i+1,e)+".html":""}else g_postfix="";"1"==g_setup_wizard_page&&"hilink"!=g_Driver_classify&&"1"==g_auto_update_enable&&(HOME_PAGE_URL="quicksetup.html")}function initPage(){button_enable("pinrequired_button_apply","0"),button_enable("link_login","1"),getAjaxData("api/pin/status",(function(e){var i=xml2object(e);"response"==i.type&&(MACRO_PUK_REQUIRED==i.response.SimState?gotoPageWithoutHistory(PUK_REQUIRED_PAGE+window.location.search):MACRO_PIN_READY==i.response.SimState?gotoPageWithoutHistory(HOME_PAGE_URL+window.location.search):MACRO_PIN_REQUIRED==i.response.SimState?($("#pinrequired_input_pin").val(""),$("#pinrequired_input_pin").focus(),$("#label_SimPINTimes").text(i.response.SimPinTimes),readSimsavepinenable()):redirectOnCondition()||gotoPageWithoutHistory(HOME_PAGE_URL+window.location.search))}),{sync:!0}),flag_focus=!0}function readSimsavepinenable(){getAjaxData("api/pin/save-pin",(function(e){var i=xml2object(e);"response"==i.type?g_simSavePinEnnable=i.response.simsavepinenable:getAjaxData("api/device/basic_information",(function(e){"response"==(i=xml2object(e)).type&&(g_simSavePinEnnable=i.response.sim_save_pin_enable)}),{sync:!0}),0==g_simSavePinEnnable||1==g_simSavePinEnnable?$("#simsavepinenable").text(IDS_pincoderequired_pin_disable_pin):2==g_simSavePinEnnable?$("#simsavepinenable").text(dialup_hilink_label_save_pin_code):$("#simsavepinenable").text(IDS_pincoderequired_pin_disable_pin)}))}function pinValidateInput(){$("#pinrequired_error").html("");var e=$("#pinrequired_input_pin").val();return""==e?($("#pinrequired_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#pinrequired_input_pin").focus(),$("#pinrequired_input_pin").val(""),button_enable("pinrequired_button_apply","0"),!1):!!/^[0-9]{4,8}$/.exec(e)||($("#pinrequired_error").html(dialup_hint_pin_code_valid_type).attr("class","error_message"),$("#pinrequired_input_pin").focus(),$("#pinrequired_input_pin").val(""),button_enable("pinrequired_button_apply","0"),!1)}function pinreq_validate_savePin(e,i){button_enable("pinrequired_button_apply","0"),button_enable("link_login","0");var n={SimSavepinStatus:i,SimSavepinPIN:e.CurrentPin,simsavepinenable:g_simSavePinEnnable},t=object2xml("request",e);saveAjaxData("api/pin/operate",t,(function(e){var i=xml2object(e);if(isAjaxReturnOK(i)){var t=object2xml("request",n);if(saveAjaxData("api/pin/save-pin",t,(function(e){}),{sync:!0,enc:!0}),!redirectOnCondition())return".html"==g_postfix||""==g_postfix?gotoPageWithoutHistory(HOME_PAGE_URL):gotoPageWithoutHistory(g_postfix),!1}else closeWaitingDialog(),showInfoDialog(common_failed),setTimeout((function(){initPage()}),500)}),{sync:!0,enc:!0})}function onApply(){if($.each($("input"),(function(){$(this).blur(),flag_focus=!0})),pinValidateInput()){var e=$("#pinrequired_checkbox_savepin").get(0).checked?1:0,i=$("#pinrequired_input_pin").val(),n={OperateType:MACRO_PIN_OPERATE_VALIDATE,CurrentPin:i,NewPin:"",PukCode:""};$("#pinrequired_input_pin").val(""),pinreq_validate_savePin(n,e)}}function checkPinCodeValidated(){button_enable("pinrequired_button_apply","0"),getAjaxData("api/pin/status",(function(e){var i=xml2object(e);"response"==i.type?MACRO_PUK_REQUIRED==i.response.SimState?gotoPageWithoutHistory(PUK_REQUIRED_PAGE+window.location.search):MACRO_PIN_READY==i.response.SimState?(showInfoDialog(pin_has_been_validated),setTimeout((function(){return".html"==g_postfix||""==g_postfix?gotoPageWithoutHistory(HOME_PAGE_URL):gotoPageWithoutHistory(g_postfix),!1}),1500)):onApply():(showInfoDialog(pin_code_validate_failed),setTimeout((function(){return initPage(),!1}),1500))}))}main_beforeready();var userAgents=navigator.userAgent.toLowerCase();$(document).ready((function(){$("#save_setting").html(IDS_pincoderequired_pin_disable_pin+common_colon),$("#pinrequired_input_pin").focus(),$("#pinrequired_input_pin").bind("keyup change input paste cut keydown",(function(){$(this).val().length>=4?button_enable("pinrequired_button_apply","1"):button_enable("pinrequired_button_apply","0")})),$("#pinrequired_button_apply").click((function(){isButtonEnable("pinrequired_button_apply")&&getLoginStatus(checkPinCodeValidated,"pincoderequired.html")&&checkPinCodeValidated()})),1==g_feature.continue_button?$("#link_login").show():$("#link_login").hide(),initPage(),getLoginStatus(),userAgents.indexOf("trident")>0&&("10.0"==$.browser.version||"11.0"==$.browser.version)&&$("#pop_login").attr("tabindex","3"),setLoginStatus("pincoderequired.html"),$("#link_login").click((function(){window.location=HOME_PAGE_URL})),$("#link_login").bind("click",(function(){isButtonEnable("pinrequired_button_apply")&&getLoginStatus(checkPinCodeValidated,"pincoderequired.html")&&checkPinCodeValidated()}))}));
