var g_monitoring_traffic_statistics=null,g_wlan_security_settings=null,g_connection_trafficresponse=null,g_wlanMaxApnNum=0,g_wlanClientInfo=[],MACRO_NUMBER_TRUE=1,MACRO_NUMBER_FALSE=0,MACRO_PREFIX_TIMER=1,MACRO_VALUE_START_DATE=1,MACRO_VALUE_THRESHOLD=90,g_set_data_package=MACRO_NUMBER_FALSE,g_Monthly_volume=!1,g_prefix_wlan=!1,g_tab_mobile=MACRO_NUMBER_TRUE,MIN_IDLE_THRESHOLD=0,MAX_IDLE_THRESHOLD=100,g_agile_no_set_package_mobile=null,g_agile_no_set_package_wlan=null,g_current_month_mobile={CurrentMonthDownload:"",CurrentMonthUpload:"",MonthDuration:"",MonthLastClearTime:""},g_current_month_wlan={CurrentMonthDownload:"",CurrentMonthUpload:"",MonthDuration:"",MonthLastClearTime:""},g_monthly_info_mobile={start_date:"",data_limit:"",month_threshold:"",unit_select:"",set_data_flag:""},g_monthly_info_wlan={start_date:"",data_limit:"",month_threshold:"",unit_select:"",set_data_flag:""},g_agile_startdata_list=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],g_start_date_mobile={current_date:1,supportted_dates:[]},g_start_date_wlan={current_date:1,supportted_dates:[]},g_MacfilterData=null,blockCount=0,MAX_BLACKLIST_COUNT=10,macBlankItem=[],g_set_package_table_mobile="<div id='statistics_mobile_name' class='agile_set_dialog'><h2>";g_set_package_table_mobile+=IDS_statistics_aglie_mobile_title+"</h2>",g_set_package_table_mobile+="<table> <tbody> <tr> <td>",g_set_package_table_mobile+=IDS_statistics_aglie_set_start_date+common_colon+"</td>",g_set_package_table_mobile+="<td> <select id='mobile_start_date_select'></select> </td> </tr>",g_set_package_table_mobile+="<tr id='mobile_data_volume_tr'> <td>"+IDS_statistics_aglie_set_data_volume_mobile+common_colon+"</td>",g_set_package_table_mobile+="<td> <input style='width:100px;' type='text' class='Arabic_dialupNumber'  id='mobile_data_volume' maxlength='6'>",g_set_package_table_mobile+=" <span><select id='mobile_data_nuit_select' style='width:60px;'><option value='MB'>",g_set_package_table_mobile+=common_unit_mb+"</option>",g_set_package_table_mobile+='<option value="GB">'+common_unit_gb+"</option>",g_set_package_table_mobile+="</select></span></input> </td> </tr>",g_set_package_table_mobile+="<tr id='mobile_threshold_tr'> <td> ",g_set_package_table_mobile+=IDS_statistics_aglie_data_threshold+common_colon+"</td>",g_set_package_table_mobile+="<td> <input style='width:50px;' class='Arabic_dialupNumber' id='mobile_threshold_select' maxlength='3'></input>",g_set_package_table_mobile+=" % </td> </tr>",g_set_package_table_mobile+="</tbody> </table>",g_set_package_table_mobile+="</div>";var g_set_package_table_wlan="<div id='statistics_wifi_name' class='agile_set_dialog'><h2>";function agile_setting_validInput(){function t(t,e){var a=t+"_wrong";$("#"+t).closest("tr").after("<tr class='pro_wrong'><td>&nbsp;</td><td colspan='2' class='error_message' id='temp_wrong'>&nbsp;</td></tr>"),$("#temp_wrong").attr("id",a),$("#"+a).html(e),$("#"+t).focus()}function e(e){var a=!0,_=$.trim($("#"+e).val());return 1==isNaN(_)||""==_?(a=!1,t(e,IDS_statistics_aglie_number)):0==_.indexOf("0")&&0!=parseInt(_,10)||-1!=_.indexOf(".")?(a=!1,t(e,IDS_statistics_aglie_input_invalid)):"mobile_threshold_select"==e||"wifi_threshold_select"==e?(parseInt(_,10)<MIN_IDLE_THRESHOLD||parseInt(_,10)>MAX_IDLE_THRESHOLD)&&(a=!1,t(e,IDS_statistics_aglie_range)):parseInt(_,10)<MIN_IDLE_THRESHOLD&&(a=!1,t(e,IDS_statistics_aglie_input_invalid)),a&&$("#"+e).val(_),a}var a=!1;return $.each($(".pro_wrong"),(function(t){$(this).remove()})),$.each($("input"),(function(){$(this).blur()})),a=e("mobile_data_volume"),a&=e("mobile_threshold_select"),g_prefix_wlan&&g_module.wifioffload_enable&&(a&=e("wifi_data_volume"),a&=e("wifi_threshold_select")),a}function getTrafficInfo(t){var e=0,a="";return"ar_sa"==LANGUAGE_DATA.current_language||"he_il"==LANGUAGE_DATA.current_language||"fa_fa"==LANGUAGE_DATA.current_language?g_monitoring_dumeter_kb>t?(e=formatFloat(parseFloat(t),2),a=common_unit_byte+" "+e):g_monitoring_dumeter_kb<=t&&g_monitoring_dumeter_mb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_kb,2),a=common_unit_kb+" "+e):g_monitoring_dumeter_mb<=t&&g_monitoring_dumeter_gb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_mb,2),a=common_unit_mb+" "+e):g_monitoring_dumeter_gb<=t&&g_monitoring_dumeter_tb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_gb,2),a=common_unit_gb+" "+e):(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_tb,2),a=common_unit_tb+" "+e):(t*=8,a=g_monitoring_dumeter_kb>t?(e=formatFloat(parseFloat(t),2))+" "+common_unit_byteps:g_monitoring_dumeter_kb<=t&&g_monitoring_dumeter_mb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_kb,2))+" "+common_unit_kbps:g_monitoring_dumeter_mb<=t&&g_monitoring_dumeter_gb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_mb,2))+" "+common_unit_mbps:g_monitoring_dumeter_gb<=t&&g_monitoring_dumeter_tb>t?(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_gb,2))+" "+common_unit_gbps:(e=formatFloat(parseFloat(t)/g_monitoring_dumeter_tb,2))+" "+common_unit_tbps),a}function getTrafficInfo2(t){return g_monitoring_dumeter_kb>t?formatFloat(parseFloat(t),2)+" "+common_unit_byte:g_monitoring_dumeter_kb<=t&&g_monitoring_dumeter_mb>t?formatFloat(parseFloat(t)/g_monitoring_dumeter_kb,2)+" "+common_unit_kb:g_monitoring_dumeter_mb<=t&&g_monitoring_dumeter_gb>t?formatFloat(parseFloat(t)/g_monitoring_dumeter_mb,2)+" "+common_unit_mb:g_monitoring_dumeter_gb<=t&&g_monitoring_dumeter_tb>t?formatFloat(parseFloat(t)/g_monitoring_dumeter_gb,2)+" "+common_unit_gb:formatFloat(parseFloat(t)/g_monitoring_dumeter_tb,2)+" "+common_unit_tb}function setTrafficHTML(){if(null!=(g_connection_trafficresponse=g_monitoring_traffic_statistics)&&""!=g_connection_trafficresponse){$("#current_upload").html(getTrafficInfo2(g_connection_trafficresponse.CurrentUpload)),$("#current_download").html(getTrafficInfo2(g_connection_trafficresponse.CurrentDownload)),$("#total_current").html(getTrafficInfo(parseInt(g_connection_trafficresponse.CurrentUpload,10)+parseInt(g_connection_trafficresponse.CurrentDownload,10)));var t=getCurrentTime(g_connection_trafficresponse.CurrentConnectTime);$("#current_duration").html(t),$("#history_upload").html(getTrafficInfo(g_connection_trafficresponse.TotalUpload)),$("#history_download").html(getTrafficInfo(g_connection_trafficresponse.TotalDownload)),$("#total_history").html(getTrafficInfo(parseInt(g_connection_trafficresponse.TotalUpload,10)+parseInt(g_connection_trafficresponse.TotalDownload,10)));var e=getCurrentTime(g_connection_trafficresponse.TotalConnectTime,10);$("#history_duration").html(e)}if(g_module.wifioffload_enable&&null!=G_StationStatus){$("#wifi_current_download").html(getTrafficInfo(G_StationStatus.response.RxFlux)),$("#wifi_current_upload").html(getTrafficInfo(G_StationStatus.response.TxFlux)),$("#wifi_total_current").html(getTrafficInfo(parseInt(G_StationStatus.response.TxFlux,10)+parseInt(G_StationStatus.response.RxFlux,10))),$("#wifi_history_download").html(getTrafficInfo(G_StationStatus.response.TotalRxFlux)),$("#wifi_history_upload").html(getTrafficInfo(G_StationStatus.response.TotalTxFlux)),$("#wifi_total_history").html(getTrafficInfo(parseInt(G_StationStatus.response.TotalTxFlux,10)+parseInt(G_StationStatus.response.TotalRxFlux,10)));var a=getCurrentTime(G_StationStatus.response.CurrentTime),_=getCurrentTime(G_StationStatus.response.TotalTime);$("#wifi_current_duration").html(a),$("#wifi_history_duration").html(_)}}function agile_no_set_data_package(){if(""!=g_agile_no_set_package_mobile){var t=getTrafficInfo2(parseInt(g_agile_no_set_package_mobile.CurrentUpload,10)+parseInt(g_agile_no_set_package_mobile.CurrentDownload,10)),e=getCurrentTime(g_agile_no_set_package_mobile.CurrentConnectTime),a=getTrafficInfo2(parseInt(g_agile_no_set_package_mobile.TotalUpload,10)+parseInt(g_agile_no_set_package_mobile.TotalDownload,10)),_=getCurrentTime(g_agile_no_set_package_mobile.TotalConnectTime),i=getTrafficInfo(g_agile_no_set_package_mobile.CurrentDownloadRate),o=getTrafficInfo(g_agile_no_set_package_mobile.CurrentUploadRate)+"&nbsp;&nbsp;";$("#mobile_current_volume").html(t),$("#mobile_current_duration").html(e),$("#new_mobile_current_duration").html(e),$("#mobile_history_volume").html(a),$("#mobile_history_duration").html(_),$("#mobile_current_down_speed").html(i),$("#mobile_current_up_speed").html(o),$("#last_clear_time").html(XSSResolveCannotParseChar(g_current_month_mobile.MonthLastClearTime))}}function getTrafficStatus(){getAjaxData("api/monitoring/traffic-statistics",(function(t){var e=xml2object(t);"response"==e.type&&(g_monitoring_traffic_statistics=e.response,setTrafficHTML(),g_agile_no_set_package_mobile=g_monitoring_traffic_statistics,agile_no_set_data_package())}))}function getApStationTrafficStatus(){getAjaxData("api/wlan/station-information",(function(t){var e=xml2object(t);"response"==e.type&&(G_StationStatus=e,setTrafficHTML())}))}function getWlanMultiSSIDStatus(){getAjaxData("api/wlan/wifi-feature-switch",(function(t){var e=xml2object(t);"response"==e.type&&(g_wlanMaxApnNum=parseInt(e.response.maxapnum,10))}),{sync:!0}),g_wlanMaxApnNum>=1||g_module.multi_ssid_enabled?getWlanMultiSSIDName():getWlanBasicSSIDName()}function getWlanBasicSSIDName(){getAjaxData("api/wlan/basic-settings",(function(t){var e=xml2object(t);if("response"==e.type){var a={SsidName:e.response.WifiSsid,SsidNumber:0};(g_wlanClientInfo=[]).push(a)}}),{sync:!0})}function getWlanMultiSSIDName(){getAjaxData("api/wlan/multi-basic-settings",(function(t){var e=xml2object(t);if("response"==e.type&&void 0!==e.response.Ssids.Ssid){var a=CreateArray(e.response.Ssids.Ssid);g_wlanClientInfo=[],$.each(a,(function(t,e){var a={SsidName:"",SsidNumber:0};a.SsidName=e.WifiSsid,g_wlanClientInfo.push(a)}))}}),{sync:!0})}function getAuthenInfo(){getAjaxData("api/wlan/host-list",(function(t){var e=xml2object(t),a=[],_=[],i=0;if("response"==e.type){for($("#table_wifiClient > tbody > tr:gt(0)").remove(),i=0;i<g_wlanClientInfo.length;i++)g_wlanClientInfo[i].SsidNumber=0,_[i]="";if((a=CreateArray(e.response.Hosts.Host)).length<1)return;for($.each(a,(function(t,e){var a=getCurrentTime(e.AssociatedTime);for(i=0;i<g_wlanClientInfo.length;i++)e.AssociatedSsid==g_wlanClientInfo[i].SsidName&&(g_wlanClientInfo[i].SsidNumber++,_[i]+="<tr><td class='bottom_id'>"+e.ID+"</td>",_[i]+="<td class='bottom_ip'>"+XSSResolveCannotParseChar(e.IpAddress)+"</td>",_[i]+="<td class='bottom_host'>"+XSSResolveCannotParseChar(e.HostName)+"</td>",_[i]+="<td class='bottom_mac'>"+XSSResolveCannotParseChar(e.MacAddress)+"</td>",_[i]+="<td class='bottom_associat'>"+XSSResolveCannotParseChar(a)+"</td>",_[i]+="<td class='bottom_operation'><span class='operation_block'>"+IDS_statistic_operation_block+"<span></td></tr>")})),i=0;i<g_wlanClientInfo.length;i++)g_wlanClientInfo[i].SsidNumber>0&&((g_wlanMaxApnNum>1||g_module.multi_ssid_enabled)&&(_[i]='<tr><td colspan="5" class="tr_bg">'+wlan_label_multi_ssid_clients+(i+1)+common_colon+" "+g_wlanClientInfo[i].SsidNumber+"</td></tr>"+_[i]),$("#table_wifiClient").append(_[i]))}}))}function agile_print_start_date_mobile(){$("#mobile_start_date_select").val(g_monthly_info_mobile.start_date),$("#mobile_data_volume").val(g_monthly_info_mobile.data_limit),$("#mobile_threshold_select").val(g_monthly_info_mobile.month_threshold),"GB"==g_monthly_info_mobile.unit_select?$("#mobile_data_nuit_select").val("GB"):"MB"==g_monthly_info_mobile.unit_select&&$("#mobile_data_nuit_select").val("MB")}function agile_print_start_date_wlan(){$("#wifi_start_date_select").val(g_monthly_info_wlan.start_date),$("#wifi_data_volume").val(g_monthly_info_wlan.data_limit),$("#wifi_threshold_select").val(g_monthly_info_wlan.month_threshold),"GB"==g_monthly_info_wlan.unit_select?$("#wifi_data_nuit_select").val("GB"):"MB"==g_monthly_info_wlan.unit_select&&$("#wifi_data_nuit_select").val("MB")}function agile_get_volume(){agile_get_mobile_volume(),g_prefix_wlan&&g_module.wifioffload_enable&&agile_get_wlan_volume()}function agile_get_start_date_mobile(t,e){t=0!=t,getAjaxData("api/monitoring/start_date",(function(t){var a=xml2object(t);if("response"==a.type){var _=a.response,i=_.DataLimit.length;if(0==i)g_monthly_info_mobile.data_limit=0,g_monthly_info_mobile.unit_select="GB";else{var o=_.DataLimit.substring(0,i-2),l=_.DataLimit.substring(i-2,i).toUpperCase();g_monthly_info_mobile.data_limit=parseInt(o,10),g_monthly_info_mobile.unit_select=l}"0"==_.StartDay||""==_.StartDay?g_monthly_info_mobile.start_date=MACRO_VALUE_START_DATE:g_monthly_info_mobile.start_date=parseInt(_.StartDay,10),"0"==_.MonthThreshold||""==_.MonthThreshold?g_monthly_info_mobile.month_threshold=MACRO_VALUE_THRESHOLD:g_monthly_info_mobile.month_threshold=_.MonthThreshold,g_monthly_info_mobile.set_data_flag=_.SetMonthData,g_set_data_package=parseInt(g_monthly_info_mobile.set_data_flag,10)}"function"==typeof e&&e()}),{sync:t})}function agile_get_start_date_wlan(){getAjaxData("api/monitoring/start_date_wlan",(function(t){var e=xml2object(t);if("response"==e.type){var a=e.response,_=a.DataLimit.length;if(0==_)g_monthly_info_wlan.data_limit=0,g_monthly_info_wlan.unit_select="GB";else{var i=a.DataLimit.substring(0,_-2),o=a.DataLimit.substring(_-2,_).toUpperCase();g_monthly_info_wlan.data_limit=parseInt(i,10),g_monthly_info_wlan.unit_select=o}"0"==a.StartDay||""==a.StartDay?g_monthly_info_wlan.start_date=MACRO_VALUE_START_DATE:g_monthly_info_wlan.start_date=parseInt(a.StartDay,10),"0"==a.MonthThreshold||""==a.MonthThreshold?g_monthly_info_wlan.month_threshold=MACRO_VALUE_THRESHOLD:g_monthly_info_wlan.month_threshold=a.MonthThreshold,g_monthly_info_wlan.set_data_flag=a.SetMonthData,g_set_data_package=parseInt(g_monthly_info_wlan.set_data_flag,10)}}),{sync:!0})}function agile_get_start_date_selected(t,e,a){var _=$("#"+e),i="";if($.isArray(t.supportted_dates))$.each(t.supportted_dates,(function(t,e){i+="<option value = "+e+">"+e+"</option>"}));else if(void 0!==t.supportted_dates){var o=t.supportted_dates;_&&_.val(o),i+="<option value = "+o+">"+o+"</option>"}$.isArray(t.supportted_dates)?(_.append(i),setTimeout((function(){_.val(a)}),MACRO_PREFIX_TIMER)):_.hide()}function agile_init_start_date_list(){g_start_date_mobile.supportted_dates=g_agile_startdata_list,g_start_date_wlan.supportted_dates=g_agile_startdata_list,agile_get_start_date_mobile(),agile_print_start_date_mobile(),agile_get_start_date_selected(g_start_date_mobile,"mobile_start_date_select",g_monthly_info_mobile.start_date),g_prefix_wlan&&g_module.wifioffload_enable&&(agile_get_start_date_wlan(),agile_print_start_date_wlan(),agile_get_start_date_selected(g_start_date_wlan,"wifi_start_date_select",g_monthly_info_wlan.start_date))}function getAllInfo(){getGMonitoringStatus(),getTrafficStatus(),g_module.wifioffload_enable&&getApStationTrafficStatus(),G_MonitoringStatus.response.CurrentWifiUser>0?(getAuthenInfo(),$("#table_wifiClient").show()):$("#table_wifiClient > tbody > tr:gt(0)").remove(),g_module.wifi_enabled&&showBlockList(),g_Monthly_volume&&agile_get_start_date_mobile(!1,agile_get_volume()),setTimeout(getAllInfo,g_feature.update_interval)}function refreshTraffic(){var t=object2xml("request",{ClearTraffic:1});saveAjaxData("api/monitoring/clear-traffic",t,(function(t){"response"==xml2object(t).type&&(getTrafficStatus(),g_module.wifioffload_enable&&getApStationTrafficStatus())}))}function cancel_RefreshTraffic(){$("#div_wrapper").remove(),$(".dialog").remove()}function agile_click_init(t){function e(){if(isButtonEnable("button_set_package")){var t="";t=g_set_package_table_mobile,g_prefix_wlan&&g_module.wifioffload_enable&&(t+=g_set_package_table_wlan),call_dialog(IDS_statistics_aglie_set_package_dialog,t,common_save,"pop_Save",common_cancel,"pop_Cancel"),agile_init_start_date_list()}}MACRO_NUMBER_TRUE==g_set_data_package&&agile_switch_to_edit(),$("#pop_Save").live("click",(function(){if(isButtonEnable("pop_Save")){agile_setting_validInput()&&(agile_save_data_settings(),MACRO_NUMBER_TRUE==g_set_data_package?agile_switch_to_edit():(clearDialog(),$("#agile_lgtab").hide(),$(".agile_station").show(),$(".agile_station_button").show()),agile_get_start_date_mobile())}})),$("#button_set_package").click((function(){e()})),$("#agile_edit_volume").live("click",(function(){e()})),$("#agile_ettab_mobile").mouseover((function(){$("#agile_ettab_mobile").hasClass("pressed")||$("#agile_ettab_mobile").removeClass("pressed").removeClass("normal").addClass("hover").addClass("clr_bold").removeClass("clr_white")})),$("#agile_ettab_mobile").mouseout((function(){$("#agile_ettab_mobile").hasClass("pressed")||$("#agile_ettab_mobile").removeClass("pressed").removeClass("hover").addClass("normal").addClass("clr_bold").removeClass("clr_white")})),$("#agile_ettab_wifi").mouseover((function(){$("#agile_ettab_wifi").hasClass("pressed")||$("#agile_ettab_wifi").removeClass("pressed").removeClass("normal").addClass("hover").addClass("clr_bold").removeClass("clr_white")})),$("#agile_ettab_wifi").mouseout((function(){$("#agile_ettab_wifi").hasClass("pressed")||$("#agile_ettab_wifi").removeClass("pressed").removeClass("hover").addClass("normal").addClass("clr_bold").removeClass("clr_white")})),$("#agile_ettab_mobile").live("click",(function(){isButtonEnable("agile_ettab_mobile")&&(g_tab_mobile=MACRO_NUMBER_TRUE,g_prefix_wlan&&g_module.wifioffload_enable&&(button_enable("agile_ettab_wifi","1"),$("#agile_ettab_wifi").removeClass("pressed").addClass("normal").addClass("clr_bold").removeClass("clr_white")),$("#agile_ettab_mobile").removeClass("normal").removeClass("hover").removeClass("clr_bold").addClass("clr_white").addClass("pressed"),button_enable("agile_ettab_mobile","0"),agile_get_mobile_volume())})),g_prefix_wlan&&g_module.wifioffload_enable&&$("#agile_ettab_wifi").live("click",(function(){isButtonEnable("agile_ettab_wifi")&&(g_tab_mobile=MACRO_NUMBER_FALSE,$("#agile_ettab_mobile").removeClass("pressed").addClass("normal").addClass("clr_bold").removeClass("clr_white"),$("#agile_ettab_wifi").removeClass("normal").removeClass("hover").removeClass("clr_bold").addClass("clr_white").addClass("pressed"),button_enable("agile_ettab_wifi","0"),button_enable("agile_ettab_mobile","1"),agile_get_wlan_volume())}))}function agile_statistics_init(t){function e(){agile_get_mobile_volume(),agile_get_start_date_mobile(),$("#last_clear_time").html(XSSResolveCannotParseChar(g_current_month_mobile.MonthLastClearTime))}g_Monthly_volume=g_module.monthly_volume_enabled,getTrafficStatus(),t?g_Monthly_volume?($(".have_station").remove(),$(".no_station").remove(),g_agile_no_set_package_mobile?e():setTimeout(e,MACRO_PREFIX_TIMER),MACRO_NUMBER_FALSE==g_set_data_package&&(g_prefix_wlan||$("#statistics_wifi").hide(),$(".agile_station").show(),$(".agile_station_button").show())):($(".no_station").remove(),$(".agile_station").remove(),$(".agile_station_button").remove(),$(".agile_clear_time").remove(),$(".have_station").show()):g_Monthly_volume?($(".have_station").remove(),$(".no_station").remove(),g_agile_no_set_package_mobile?e():setTimeout(e,MACRO_PREFIX_TIMER),MACRO_NUMBER_FALSE==g_set_data_package&&($("#statistics_wifi").hide(),$(".agile_station").show(),$(".agile_station_button").show())):($(".no_station").show(),$(".agile_station").remove(),$(".agile_station_button").remove(),$(".agile_clear_time").remove(),$(".have_station").remove())}function agile_adapter_unit(t,e){var a=0;return"B"==e?a=t:"KB"==e?a=g_monitoring_dumeter_kb*t:"MB"==e?a=g_monitoring_dumeter_mb*t:"GB"==e?a=g_monitoring_dumeter_gb*t:"TB"==e&&(a=g_monitoring_dumeter_tb*t),a}g_set_package_table_wlan+=IDS_statistics_aglie_wifi_title+"</h2>",g_set_package_table_wlan+="<table> <tbody> <tr> <td>",g_set_package_table_wlan+=IDS_statistics_aglie_wifi_set_enable+common_colon+"</td>",g_set_package_table_wlan+="<td> <select id='wifi_set_enable_select' value='Enable'><option value = ' + value + '>",g_set_package_table_wlan+=common_enable+"</option>",g_set_package_table_wlan+="<option value = ' + value + '>"+common_disable+"</option>",g_set_package_table_wlan+="</select> </td> </tr>",g_set_package_table_wlan+="<tr><td>"+IDS_statistics_aglie_set_start_date+common_colon+"</td>",g_set_package_table_wlan+="<td> <select id='wifi_start_date_select'></select> </td> </tr>",g_set_package_table_wlan+="<tr id='wifi_data_volume_tr'> <td>"+IDS_statistics_aglie_set_data_volume_wlan+common_colon+"</td>",g_set_package_table_wlan+="<td> <input style='width:100px;' type='text' class='Arabic_dialupNumber'  id='wifi_data_volume' maxlength='6'>",g_set_package_table_wlan+=" <span><select id='wifi_data_nuit_select' style='width:60px;'><option value = ' + value + '>",g_set_package_table_wlan+=common_unit_mb+"</option>",g_set_package_table_wlan+="<option value = ' + value + '>"+common_unit_gb+"</option>",g_set_package_table_wlan+="</select></span></input> </td> </tr>",g_set_package_table_wlan+="<tr id='wifi_threshold_tr'> <td> ",g_set_package_table_wlan+=IDS_statistics_aglie_data_threshold+common_colon+"</td>",g_set_package_table_wlan+="<td> <input class='Arabic_dialupNumber'  id='wifi_threshold_select' style='width:50px;' maxlength='3'></input> % </td> </tr>",g_set_package_table_wlan+="</tbody> </table>",g_set_package_table_wlan+="</div>";var g_data_unit=null;function agile_set_month_volue(t,e,a){var _=0,i=0,o=0,l=0;if($("#mobile_month_volume").html(getTrafficInfo2(parseInt(t.CurrentMonthDownload,10)+parseInt(t.CurrentMonthUpload,10))),$("#mobile_month_duration").html(getCurrentTime(t.MonthDuration)),$("#month_duration").html(getCurrentTime(t.MonthDuration)),$("#month_used_value").html(getTrafficInfo2(parseInt(t.CurrentMonthDownload,10)+parseInt(t.CurrentMonthUpload,10))),e){var n=parseInt(t.CurrentMonthDownload,10)+parseInt(t.CurrentMonthUpload,10),s=parseInt(g_agile_no_set_package_mobile.TotalUpload,10)+parseInt(g_agile_no_set_package_mobile.TotalDownload,10);o=parseInt(g_agile_no_set_package_mobile.TotalConnectTime,10)<parseInt(t.MonthDuration,10)?parseInt(t.MonthDuration,10):parseInt(g_agile_no_set_package_mobile.TotalConnectTime,10),l=n>s?n:s,g_data_unit="GB"==g_monthly_info_mobile.unit_select?common_unit_gb:common_unit_mb,"ar_sa"==LANGUAGE_DATA.current_language||"he_il"==LANGUAGE_DATA.current_language||"fa_fa"==LANGUAGE_DATA.current_language?$("#month_total_value").html(g_data_unit+" "+g_monthly_info_mobile.data_limit):$("#month_total_value").html(g_monthly_info_mobile.data_limit+" "+g_data_unit),$("#total_value_used").html(getTrafficInfo2(l)),$("#total_value_duration").html(getCurrentTime(o)),_=agile_adapter_unit(g_monthly_info_mobile.data_limit,g_monthly_info_mobile.unit_select),i=g_monthly_info_mobile.month_threshold/MAX_IDLE_THRESHOLD}else if(a){var r=parseInt(t.CurrentMonthDownload,10)+parseInt(t.CurrentMonthUpload,10),m=parseInt(g_agile_no_set_package_wlan.TotalUpload,10)+parseInt(g_agile_no_set_package_wlan.TotalDownload,10);o=parseInt(g_agile_no_set_package_wlan.TotalConnectTime,10)<parseInt(t.MonthDuration,10)?parseInt(t.MonthDuration,10):parseInt(g_agile_no_set_package_wlan.TotalConnectTime,10),l=r>m?r:m,g_data_unit="GB"==g_monthly_info_mobile.unit_select?common_unit_gb:common_unit_mb,"ar_sa"==LANGUAGE_DATA.current_language||"he_il"==LANGUAGE_DATA.current_language||"fa_fa"==LANGUAGE_DATA.current_language?$("#month_total_value").html(g_data_unit+" "+g_monthly_info_wlan.data_limit):$("#month_total_value").html(g_monthly_info_wlan.data_limit+" "+g_data_unit),$("#total_value_used").html(getTrafficInfo2(l)),$("#total_value_duration").html(getCurrentTime(o)),_=agile_adapter_unit(g_monthly_info_wlan.data_limit,g_monthly_info_wlan.unit_select),i=g_monthly_info_wlan.month_threshold/MAX_IDLE_THRESHOLD}var c=parseInt(t.CurrentMonthDownload,10)+parseInt(t.CurrentMonthUpload,10);if(MACRO_NUMBER_FALSE!=_){var g=c/_,d=parseInt($(".agile_progress_bar").width(),10),u=d*g;if(g>i){var f=Math.min(u,d);$("#agile_used_volume").hide(),$("#agile_threshold").css({width:f,display:"block"}),$("#agile_threshold").show()}else $("#agile_threshold").hide(),$("#agile_used_volume").css({width:u}),$("#agile_used_volume").show()}else $("#agile_used_volume").hide(),$("#agile_threshold").hide()}function agile_get_mobile_volume(){g_tab_mobile&&getAjaxData("api/monitoring/month_statistics",(function(t){var e=xml2object(t);if("response"===e.type){var a=e.response;g_current_month_mobile.MonthLastClearTime=a.MonthLastClearTime,$("#last_clear_time").html(XSSResolveCannotParseChar(g_current_month_mobile.MonthLastClearTime)),agile_set_month_volue(a,!0,!1)}}))}function agile_get_wlan_volume(){g_tab_mobile||getAjaxData("api/monitoring/month_statistics_wlan",(function(t){var e=xml2object(t);if("response"===e.type){var a=e.response;g_current_month_wlan.MonthLastClearTime=a.MonthLastClearTime,agile_set_month_volue(a,!1,!0)}}))}function agile_switch_to_edit(){clearDialog(),$(".agile_station").hide(),$(".agile_station_button").hide(),g_prefix_wlan&&g_module.wifioffload_enable?($("#agile_ettab_mobile").removeClass("hover").removeClass("normal").addClass("pressed").addClass("clr_white").removeClass("clr_bold"),$("#agile_ettab_wifi").removeClass("hover").removeClass("pressed").addClass("normal").addClass("clr_bold").removeClass("clr_white")):($(".agile_lgtab_header").hide(),$("#agile_ettab_mobile").removeClass("hover").removeClass("normal").addClass("pressed").addClass("clr_white").removeClass("clr_bold")),$("#agile_lgtab").css({display:"inline"}),button_enable("agile_edit_volume","1"),agile_get_mobile_volume(),g_prefix_wlan&&g_module.wifioffload_enable}function agile_mobile_set(){var t=$.trim($("#mobile_data_volume").val()),e=$.trim($("#mobile_start_date_select").val()),a=$.trim($("#mobile_threshold_select").val()),_=$.trim($("#mobile_data_nuit_select").val()),i=parseInt(e,10)<10?"0"+e:e;""==t&&(t=0);var o={StartDay:i,DataLimit:t+_,MonthThreshold:a,SetMonthData:parseInt(t,10)==MACRO_NUMBER_FALSE?MACRO_NUMBER_FALSE:MACRO_NUMBER_TRUE},l=object2xml("request",o);saveAjaxData("api/monitoring/start_date",l,(function(e){var a=xml2object(e);if(!isAjaxReturnOK(a))return!1;g_set_data_package=parseInt(t,10)==MACRO_NUMBER_FALSE?MACRO_NUMBER_FALSE:MACRO_NUMBER_TRUE}),{sync:!0})}function agile_wlan_set(){var t=$.trim($("#wifi_set_enable_select").val()),e=$.trim($("#wifi_data_volume").val()),a=$.trim($("#wifi_start_date_select").val()),_=$.trim($("#wifi_threshold_select").val()),i=$.trim($("#wifi_data_nuit_select").val()),o=parseInt(a,10)<10?"0"+a:a;""==e&&(e=0);var l=object2xml("request",{SettingEnbale:t,StartDay:o,DataLimit:e+i,MonthThreshold:_});saveAjaxData("api/monitoring/start_date_wlan",l,(function(t){var e=xml2object(t);isAjaxReturnOK(e)}))}function agile_save_data_settings(){agile_mobile_set()&&g_prefix_wlan&&g_module.wifioffload_enable&&agile_wlan_set()}function getBlacklistData(){null!=g_wifiFeatureSwitch&&""!=g_wifiFeatureSwitch?getAjaxData("api/wlan/multi-macfilter-settings",(function(t){var e=xml2object(t);"response"==e.type&&(g_MacfilterData=CreateArray(e.response.Ssids.Ssid))}),{sync:!0}):g_module.multi_ssid_enabled?getAjaxData("api/wlan/multi-basic-settings",(function(t){var e=xml2object(t);"response"==e.type&&(g_MacfilterData=CreateArray(e.response.Ssids.Ssid))}),{sync:!0}):getAjaxData("api/wlan/mac-filter",(function(t){var e=xml2object(t);"response"==e.type&&(g_MacfilterData=CreateArray(e.response))}),{sync:!0})}function loopMacFilter(filterValue){var macFilterName="",macFilterMac="",contentMessage="";blockCount=0;var index=1;for($("#table_blacklists > tbody > tr:gt(0)").remove(),i=0;i<10&&(macFilterMac=XSSResolveCannotParseChar(eval("filterValue.WifiMacFilterMac"+i)),macFilterName=XSSResolveCannotParseChar(eval("filterValue.wifihostname"+i)),void 0!==macFilterMac);i++)null!=macFilterMac&&""!=macFilterMac?(contentMessage+="<tr><td class='bottom_id'>"+index+"</td>",contentMessage+="<td class='bottom_host'>"+macFilterName+"</td>",contentMessage+="<td class='bottom_mac'>"+macFilterMac+"</td>",contentMessage+="<td class='bottom_operation'><span class='operation_unblock'>"+common_delete+"</span></td></tr>",index++,blockCount++):macBlankItem.push(i);if($("#table_blacklists").append(contentMessage),$(".full_blacklist").remove(),blockCount>=MAX_BLACKLIST_COUNT){var error_full="<span class='full_blacklist'>( "+IDS_statistic_blacklists_full+")</span>";$("#blacklist_title").append(error_full)}}function showBlockList(){getBlacklistData(),macBlankItem=[],$.each(g_MacfilterData,(function(t,e){2==e.WifiMacFilterStatus?loopMacFilter(g_MacfilterData[t]):macBlankItem.push(0)}))}function saveBlockUser(currentUserMac,currentUserHostname){var wifiMacFilterMac=null,saveDataCount=macBlankItem[0];$.each(g_MacfilterData,(function(i,value){if(2!=g_MacfilterData[i].WifiMacFilterStatus){g_MacfilterData[i].WifiMacFilterStatus=2;for(var j=0;j<10&&(wifiMacFilterMac=eval("g_MacfilterData[i].WifiMacFilterMac"+j),void 0!==wifiMacFilterMac);j++)eval("g_MacfilterData[i].WifiMacFilterMac"+j+"= '';"),eval("g_MacfilterData[i].wifihostname"+j+"= '';")}eval("g_MacfilterData[i].wifihostname"+saveDataCount+" = currentUserHostname;"),eval("g_MacfilterData[i].WifiMacFilterMac"+saveDataCount+" = currentUserMac;")}))}function postBlockUserData(t,e){var a=null,_="";saveBlockUser(t,e),null!=g_wifiFeatureSwitch&&""!=g_wifiFeatureSwitch?(_="api/wlan/multi-macfilter-settings",a={Ssids:{Ssid:g_MacfilterData}}):g_module.multi_ssid_enabled?(_="api/wlan/multi-basic-settings",a={Ssids:{Ssid:g_MacfilterData},WifiRestart:1}):(_="api/wlan/mac-filter",a=g_MacfilterData[0]);var i=object2xml("request",a);saveAjaxData(_,i,(function(t){var e=xml2object(t);isAjaxReturnOK(e)?(showInfoDialog(common_success),showBlockList(),getAuthenInfo()):void 0!==e.error&&e.error.code==ERROR_SYSTEM_BUSY?showInfoDialog(common_system_busy):showInfoDialog(common_failed)}))}function saveUnblockUser(currentUserMac){getBlacklistData();for(var i=0;i<g_MacfilterData.length;i++)for(var j=0;j<10;j++){var currentUserMacAddress=eval("g_MacfilterData[i].WifiMacFilterMac"+j);currentUserMacAddress==currentUserMac&&(eval("g_MacfilterData[i].WifiMacFilterMac"+j+"= '';"),eval("g_MacfilterData[i].wifihostname"+j+"= '';"))}}function postUnBlockUserData(t){var e=null,a="";saveUnblockUser(t),null!=g_wifiFeatureSwitch&&""!=g_wifiFeatureSwitch?(a="api/wlan/multi-macfilter-settings",e={Ssids:{Ssid:g_MacfilterData}}):g_module.multi_ssid_enabled?(a="api/wlan/multi-basic-settings",e={Ssids:{Ssid:g_MacfilterData},WifiRestart:1}):(a="api/wlan/mac-filter",e=g_MacfilterData[0]);var _=object2xml("request",e);saveAjaxData(a,_,(function(t){var e=xml2object(t);isAjaxReturnOK(e)?(showInfoDialog(common_success),showBlockList()):void 0!==e.error&&e.error.code==ERROR_SYSTEM_BUSY?showInfoDialog(common_system_busy):showInfoDialog(common_failed)}))}function getSSIDStatus(){""==g_wifiFeatureSwitch&&getAjaxData("api/wlan/wifi-feature-switch",(function(t){var e=xml2object(t);"response"==e.type&&(g_wifiFeatureSwitch=e.response)}),{sync:!0})}$(document).ready((function(){void 0!==user_config.force_new_statistic&&(force_new_statistic="true"==user_config.force_new_statistic),void 0!==user_config.force_old_statistic&&(force_old_statistic="true"==user_config.force_old_statistic),void 0!==user_config.force_both_statistic&&(force_both_statistic="true"==user_config.force_both_statistic),force_both_statistic?($("#new_content").show(),$("#old_content").show()):"new"==webui_mode&&!force_old_statistic||"old"==webui_mode&&force_new_statistic||"material"==webui_mode&&force_new_statistic?($("#new_content").show(),$("#old_content").hide()):("old"==webui_mode&&!force_new_statistic||"material"==webui_mode&&!force_new_statistic||"new"==webui_mode&&force_old_statistic)&&($("#new_content").hide(),$("#old_content").show()),g_module.wifioffload_enable?agile_statistics_init(MACRO_NUMBER_TRUE):agile_statistics_init(MACRO_NUMBER_FALSE),g_module.wifi_enabled||($(".status_title").remove(),$(".wifi_table").remove()),getSSIDStatus(),getWlanMultiSSIDStatus(),getAllInfo(),$("#button_clear_history").click((function(){showConfirmDialog(dialup_hint_reset_data_counter,refreshTraffic,cancel_RefreshTraffic)})),agile_get_start_date_mobile(),g_Monthly_volume&&agile_click_init(),$(".operation_block").live("click",(function(){var t=$(this).parent("td").parent("tr").children(".bottom_mac").text(),e=$(this).parent("td").parent("tr").children(".bottom_host").text();t=XSSResolveCannotParseChar(t),e=XSSResolveCannotParseChar(e);var a=g_MacfilterData[0].WifiMacFilterStatus;blockCount>=MAX_BLACKLIST_COUNT?showInfoDialog(IDS_statistic_blacklists_already_full):1==a?showConfirmDialog(IDS_statistic_whitelist_fail,(function(){postBlockUserData(t,e)}),(function(){})):showConfirmDialog(IDS_statistic_submit_blacklists,(function(){postBlockUserData(t,e)}),(function(){}))})),$(".operation_unblock").live("click",(function(){var t=$(this).parent("td").parent("tr").children(".bottom_mac").text();showConfirmDialog(IDS_statistic_restoration_user,(function(){postUnBlockUserData(t)}),(function(){}))}))}));var force_new_statistic=!1,force_old_statistic=!1,force_both_statistic=!1;
