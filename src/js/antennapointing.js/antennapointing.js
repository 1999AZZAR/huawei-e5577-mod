var CURRENT_NETWORK_NO_SERVICE=0,SERVICE_DOMAIN_NO_SERVICE=0,SERVICE_STATUS_AVAIABLE=2,g_device_mode_2g=0,g_device_mode_3g=2,g_device_mode_4g=7;function promiseAjax(e){return new Promise((function(s,n){getAjaxData(e,s,{errorCB:function(e,n){s($([e,n]))}})}))}function updateInfo(){var e="",s="",n="",t="",a="",r="",l="",o="",i="";promiseAjax("operator.cgi").then((function(e){var t=xml2object(e);"response"==t.type&&t.response.State&&(t.response.Numeric&&(s=t.response.Numeric),t.response.ShortName?n=t.response.ShortName:t.response.FullName&&(n=t.response.FullName))})).then((function(){if(!s||!n)return promiseAjax("api/net/current-plmn").then((function(e){var t=xml2object(e);"response"==t.type&&t.response.State&&(t.response.Numeric&&!s&&(s=t.response.Numeric),t.response.ShortName&&!n?n=t.response.ShortName:t.response.FullName&&!n&&(n=t.response.FullName))}))})).then((function(){if(G_MonitoringStatus.response.CurrentNetworkTypeEx)var e=G_MonitoringStatus.response.CurrentNetworkTypeEx;else e=G_MonitoringStatus.response.CurrentNetworkType;e==CURRENT_NETWORK_NO_SERVICE||G_MonitoringStatus.response.CurrentServiceDomain==SERVICE_DOMAIN_NO_SERVICE||G_MonitoringStatus.response.ServiceStatus!=SERVICE_STATUS_AVAIABLE?($("#plmn").empty(),$("#operator").text(dialup_label_no_service)):s||n?($("#plmn").text(s),$("#operator").text(n)):($("#plmn").empty(),$("#operator").empty())})),promiseAjax("api/monitoring/status").then((function(e){var s=xml2object(e);"response"==s.type&&(G_MonitoringStatus=s,getPlmn(),$("#network_mode").text(g_net_mode))})),promiseAjax("api/device/signal").then((function(s){var n=xml2object(s);if("response"==n.type)if(e=n.response.mode,n.response.cell_id&&(a=n.response.cell_id,r=Number(n.response.cell_id).toString(16).toUpperCase().addLeadZeroes(7)),n.response.rssi&&(l=n.response.rssi),e==g_device_mode_4g){if($("#signal_table_name_1").text(IDS_system_label_rsrp),$("#signal_table_name_2").text(IDS_system_label_sinr),$("#signal_table_name_3").text(IDS_system_label_rsrq),n.response.rsrp){var t=parseInt(n.response.rsrp);t>=-80?$("#signal_table_value_1").html('<span class="light-green-text">'+n.response.rsrp+"</span>"):t<=-80&&t>=-90?$("#signal_table_value_1").html('<span class="green-text">'+n.response.rsrp+"</span>"):t<=-90&&t>=-100?$("#signal_table_value_1").html('<span class="orange-text">'+n.response.rsrp+"</span>"):t<=-100&&$("#signal_table_value_1").html('<span class="red-text">'+n.response.rsrp+"</span>")}else $("#signal_table_value_1").empty();if(n.response.sinr){var o=parseInt(n.response.sinr);o>=20?$("#signal_table_value_2").html('<span class="light-green-text">'+n.response.sinr+"</span>"):o>=13&&o<=20?$("#signal_table_value_2").html('<span class="green-text">'+n.response.sinr+"</span>"):o>=0&&o<=13?$("#signal_table_value_2").html('<span class="orange-text">'+n.response.sinr+"</span>"):o<=0&&$("#signal_table_value_2").html('<span class="red-text">'+n.response.sinr+"</span>")}else $("#signal_table_value_2").empty();if(n.response.rsrq){var i=parseInt(n.response.rsrq);i>=-10?$("#signal_table_value_3").html('<span class="light-green-text">'+n.response.rsrq+"</span>"):i<=-10&&i>=-15?$("#signal_table_value_3").html('<span class="green-text">'+n.response.rsrq+"</span>"):i<=-15&&i>=-20?$("#signal_table_value_3").html('<span class="orange-text">'+n.response.rsrq+"</span>"):i<=-20&&$("#signal_table_value_3").html('<span class="red-text">'+n.response.rsrq+"</span>")}else $("#signal_table_value_3").empty()}else if(e==g_device_mode_3g){if($("#signal_table_name_1").text(IDS_system_label_rscp),$("#signal_table_name_2").text("Ec/Io"),$("#signal_table_name_3").empty(),n.response.rscp){var p=parseInt(n.response.rscp);p>=-84?$("#signal_table_value_1").html('<span class="light-green-text">'+n.response.rscp+"</span>"):p<=-84&&p>=-94?$("#signal_table_value_1").html('<span class="green-text">'+n.response.rscp+"</span>"):p<=-94&&p>=-105?$("#signal_table_value_1").html('<span class="orange-text">'+n.response.rscp+"</span>"):p<=-105&&$("#signal_table_value_1").html('<span class="red-text">'+n.response.rscp+"</span>")}else $("#signal_table_value_1").empty();if(n.response.ecio){var _=parseInt(n.response.ecio);_>=-84?$("#signal_table_value_2").html('<span class="light-green-text">'+n.response.ecio+"</span>"):_<=-84&&_>=-94?$("#signal_table_value_2").html('<span class="green-text">'+n.response.ecio+"</span>"):_<=-94&&_>=-105?$("#signal_table_value_2").html('<span class="orange-text">'+n.response.ecio+"</span>"):_<=-105&&$("#signal_table_value_2").html('<span class="red-text">'+n.response.ecio+"</span>")}else $("#signal_table_value_2").empty();$("#signal_table_value_3").empty()}else $("#signal_table_name_1").empty(),$("#signal_table_name_2").empty(),$("#signal_table_name_3").empty(),$("#signal_table_value_1").empty(),$("#signal_table_value_2").empty(),$("#signal_table_value_3").empty()})).then((function(){return promiseAjax("api/net/signal-para").then((function(e){var s=xml2object(e);"response"==s.type&&(s.response.Lac&&(t=s.response.Lac),s.response.CellID&&(a=parseInt(s.response.CellID,16),r=s.response.CellID),s.response.Rssi&&(l=s.response.Rssi))}))})).then((function(){return promiseAjax("config/deviceinformation/add_param.xml").then((function(e){var s=xml2object(e);"config"==s.type&&(s.config.lac&&(t=s.config.lac),s.config.cell_id&&(a=parseInt(s.config.cell_id,16),r=s.config.cell_id),s.config.freq1||s.config.freq2?$("#freq").text(parseInt(s.config.freq1)/10+"/"+parseInt(s.config.freq2)/10):$("#freq").empty(),s.config.bandwidth1||s.config.bandwidth2?$("#bandwidth").text(parseInt(s.config.bandwidth1)/1e3+"/"+parseInt(s.config.bandwidth2)/1e3):$("#bandwidth").empty(),s.config.rssi&&(l=s.config.rssi+"dBm"))}))})).then((function(){t?($("#lac_dec").text(parseInt(t,16)),$("#lac_hex").text(t)):($("#lac_dec").empty(),$("#lac_hex").empty()),a||r?(r=e==g_device_mode_2g?r.slice(-4):r.slice(-7),$("#cell_id_dec").text(a),$("#cell_id_hex").text(r),e==g_device_mode_4g?$("#enb").text((a>>8)+"/"+a%256):$("#enb").empty()):($("#cell_id_dec").empty(),$("#cell_id_hex").empty(),$("#enb").empty()),l?$("#rssi").text(l):$("#rssi").empty()})),promiseAjax("api/device/information").then((function(e){var s=xml2object(e);"response"==s.type&&(s.response.DeviceName&&(o=s.response.DeviceName),s.response.HardwareVersion&&s.response.HardwareVersion,s.response.SoftwareVersion?$("#firmware").text(s.response.SoftwareVersion):$("#firmware").empty(),s.response.WebUIVersion&&(i=s.response.WebUIVersion))})).then((function(){return promiseAjax("devicename.cgi").then((function(e){var s=xml2object(e);"response"==s.type&&s.response.DeviceName&&(o=s.response.DeviceName)}))})).then((function(){return o?$("#device").text(o):$("#device").empty(),promiseAjax("config/version.xml").then((function(e){var s=xml2object(e);"config"==s.type&&s.config.webui&&(i=s.config.webui)}))})).then((function(){i?$("#webui").text(i):$("#webui").empty()}))}String.prototype.addLeadZeroes=function(e){var s="";for(i=this.length;i<e;i++)s+="0";return s+this},$((function(){setInterval(updateInfo,250),$("#home_button").click((function(){gotoPageWithHistory(HOME_PAGE_URL)}))}));
