var g_ssid_error_name="",g_ssid_error_mode="",MACRO_EVDO_LEVEL_ZERO="0",MACRO_EVDO_LEVEL_ONE="1",MACRO_EVDO_LEVEL_TWO="2",MACRO_EVDO_LEVEL_THREE="3",MACRO_EVDO_LEVEL_FOUR="4",MACRO_EVDO_LEVEL_FIVE="5",g_priority_wifi_ap_info_list=[],g_wifipriorityscanresult=[],WiFi_PRIORITY_NUM=16,ap_priority_info={WifiSsid:null,WifiSecMode:null,Preset:null,Index:null,Order:null},LENGHT_OF_INDEX=8,LENGTH_OF_ERRMSG=35,ERROR_WRONG_PASSWORD="117001",SECURITY_MODE_NONE="NONE",DIAD_CONNECT="1",DIAD_DISCONNECT="0",WIFI_STATUS_ON="1",WIFI_STATUS_OFF="0",g_MonitoringStatus="",SECURITY_MODE_OPEN="OPEN",SECURITY_MODE_WEP="WEP",SECURITY_MODE_WPA_PSK="WPA-PSK",SECURITY_MODE_WPA2_PSK="WPA2-PSK",SECURITY_MODE_WPA_WPA2_PSK="WPA/WPA2-PSK",SECURITY_MODE_WPA_EAP="WPA-EAP",SECURITY_MODE_WPA2_EAP="WPA2-EAP",SECURITY_MODE_WPA_WPA2_EAP="WPA/WPA2-EAP",SECURITY_MODE_WPA_ENTERPRISE="WPA_ENTERPRISE",SECURITY_MODE_WPA2_ENTERPRISE="WPA2_ENTERPRISE",g_wifi_ap_info_list=[],g_wifiscanresult=[],g_isConnecting=!1,g_isFind=!1,g_buttonEnabled=!0,g_sync_connecting=!1,WIFI_Not_CONNECTED="-1",WIFI_CONNECTING="900",WIFI_CONNECTED="901",WIFI_DISCONNECTED="902",WIFI_DISCONNECTING="903",WIFI_CONNECT_ERROR="904",G3_PREFER=0,WIFI_PREFER=2,WIFI_SCAN_END="0",WIFI_SCANING="1",WIFI_MODE_AUTO="0",WIFI_MODE_MANUAL="1",g_status_wanpolicy=-1,g_WifiConnectionStatus=-1,g_ap_info={WifiSsid:null,WifiSignal:null,WifiAuthMode:null,WifiSecMode:null,WifiNeedPassword:null,WifiConnectStatue:WIFI_Not_CONNECTED},g_handover_setting={Handover:"1"},g_wifiscan={Wifiscan:"0"},g_current_id=null,g_isNewProfile=!1,g_isWrongPassWord=!1,g_current_index=-1,g_getHandover="",g_manualflag=!1,g_checkSimcard_enable="",CURRENT_PROFILEENABLE=1,CURRENT_WISPRENABLE=1,WifiWisprEnable="",ERROR_WISPR_PASSWORD="117004";function main_executeBeforeDocumentReady(){getAjaxData("api/wlan/sta-sim-relation",(function(i){var e=xml2object(i);"response"==e.type&&(g_checkSimcard_enable="1"==e.response.sim_relation)}),{sync:!0}),g_checkSimcard_enable&&redirectOnCondition(null,"wifinetworks")}function refreshNeedPassWord(e,t,n){for(i=0;i<g_wifipriorityscanresult.length;i++)if(g_wifipriorityscanresult[i].WifiSsid==e&&g_wifipriorityscanresult[i].WifiSecMode==t)return g_wifi_ap_info_list[n].WifiNeedPassword=!1,!0}function setWifi(i){disconnectConnectedWiFi();var e={WifiSsid:g_wifi_ap_info_list[g_current_index].WifiSsid,WifiAuthMode:g_wifi_ap_info_list[g_current_index].WifiAuthMode,WifiSecMode:g_wifi_ap_info_list[g_current_index].WifiSecMode,WifiAuthSecret:i};g_isWrongPassWord=!1,setProfileSetting(e,g_current_index),promag_cancel()}function disconnectConnectedWiFi(){g_wifi_ap_info_list.length>0&&(WIFI_CONNECTING!=g_wifi_ap_info_list[0].WifiConnectStatue&&WIFI_CONNECTED!=g_wifi_ap_info_list[0].WifiConnectStatue||(g_wifi_ap_info_list[0].WifiConnectStatue=WIFI_Not_CONNECTED))}function promag_cancel(){$("#div_wrapper").remove(),$(".dialog").remove(),$(".login_dialog").remove()}function disconnectWiFi(i){var e={DialAction:DIAD_DISCONNECT,WifiSsid:wifiSsidResolveCannotParseChar(g_wifi_ap_info_list[i].WifiSsid),WifiSecMode:g_wifi_ap_info_list[i].WifiSecMode},t=!1;WIFI_Not_CONNECTED==g_wifi_ap_info_list[i].WifiConnectStatue&&(t=!0);var n=object2xml("request",e);saveAjaxData("api/wlan/wifidial",n,(function(e){var n=xml2object(e);isAjaxReturnOK(n)&&(t||(g_wifi_ap_info_list[i].WifiConnectStatue=WIFI_DISCONNECTING,moveToTopOfApLsit(g_wifi_ap_info_list[i].WifiSsid,g_wifi_ap_info_list[i].WifiSecMode),creatWifiList()))}))}function connectWiFi(i){var e={DialAction:DIAD_CONNECT,WifiSsid:wifiSsidResolveCannotParseChar(g_wifi_ap_info_list[i].WifiSsid),WifiSecMode:g_wifi_ap_info_list[i].WifiSecMode},t=0,n=object2xml("request",e);saveAjaxData("api/wlan/wifidial",n,(function(e){var n=xml2object(e);if(isAjaxReturnOK(n)){for(;t<g_wifi_ap_info_list.length;t++)g_wifi_ap_info_list[t].WifiConnectStatue=WIFI_Not_CONNECTED;moveToTopOfApLsit(g_wifi_ap_info_list[i].WifiSsid,g_wifi_ap_info_list[i].WifiSecMode),g_wifi_ap_info_list[0].WifiConnectStatue=WIFI_CONNECTING,creatWifiList(),g_sync_connecting=!0,setTimeout((function(){g_sync_connecting=!1}),3e3),g_current_index=0}}),{sync:!0}),getAjaxData("api/monitoring/status",(function(i){var e=xml2object(i);"response"==e.type&&(G_MonitoringStatus=e)}),{sync:!0})}function setProfileSetting(i,e){i.WifiSsid=wifiSsidResolveCannotParseChar(i.WifiSsid),i.WifiAuthSecret=wifiSsidResolveCannotParseChar(i.WifiAuthSecret);var t=object2xml("request",i);saveAjaxData("api/wlan/wifiaddprofile",t,(function(i){var t=xml2object(i);isAjaxReturnOK(t)?connectWiFi(e):ERROR_SYSTEM_BUSY==t.error.code&&(showInfoDialog(common_system_busy),$("#wifi_scan").hide(),$("#wifi_no_ap").show(),button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)}),{enc:!0})}function getWiFiIndex(i){var e=i.substring(LENGHT_OF_INDEX,i.length);return parseInt(e,10)}function index_clickTrunOnBtn(){g_module.cradle_enabled?($("#scan_div").show(),checkOffloadScanEnabled()):scanWifi(),$("#wifi_switch_button").html(create_button_html(common_turn_off,"turnOff_button")),ieRadiusBorder(),"material"==webui_mode&&materializeButtons()}function index_clickTurnOffBtn(){g_module.cradle_enabled&&($("#scan_div").show(),checkOffloadEnabled()),$("#wifi_switch_button").html(create_button_html(common_turn_on,"turnOn_button")),$("#wifi_content").hide(),$("#scan_div").hide(),ieRadiusBorder(),"material"==webui_mode&&materializeButtons()}function getStatusWanPolicy(){g_status_wanpolicy!=G_MonitoringStatus.response.WanPolicy&&0==g_manualflag&&(g_handover_setting.Handover=G_MonitoringStatus.response.WanPolicy,promag_cancel(),showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments),g_manualflag=!0,g_getHandover="",g_status_wanpolicy=G_MonitoringStatus.response.WanPolicy,setTimeout((function(){getHandoverSuccessSetting()}),1500))}function getHandoverSetting(){getAjaxData("api/wlan/handover-setting",(function(i){var e=xml2object(i);"response"==e.type&&(WIFI_PREFER==e.response.Handover?(g_status_wanpolicy=WIFI_PREFER,index_clickTrunOnBtn()):(g_status_wanpolicy=G3_PREFER,index_clickTurnOffBtn())),g_module.multi_ssid_enabled?getAjaxData("api/wlan/multi-switch-settings",(function(i){1==xml2object(i).response.multissidstatus?(button_enable("turnOff_button","0"),button_enable("turnOn_button","0"),showInfoDialog(multi_wifiOffload_message)):(addStatusListener("getStatusWanPolicy()"),button_enable("turnOff_button","1"),button_enable("turnOn_button","1"))})):addStatusListener("getStatusWanPolicy()")}))}function setHandoverSetting(){var i=object2xml("request",g_handover_setting);showWaitingDialog(common_waiting,sd_hint_wait_a_few_moments),saveAjaxData("api/wlan/handover-setting",i,(function(i){var e=xml2object(i);isAjaxReturnOK(e)?(g_getHandover="",g_manualflag=!0,setTimeout((function(){getHandoverSuccessSetting()}),1e3)):(ERROR_SYSTEM_BUSY==e.error.code?(closeWaitingDialog(),showInfoDialog(common_system_busy)):(closeWaitingDialog(),showInfoDialog(common_failed)),g_status_wanpolicy==WIFI_PREFER?button_enable("turnOff_button",1):button_enable("turnOn_button",1))}),{errorCB:function(){setTimeout((function(){getHandoverSuccessSetting()}),1e3)}})}function getHandoverSuccessSetting(){getAjaxData("api/monitoring/status",(function(i){var e=xml2object(i);if("response"==e.type)if(void 0!==(g_MonitoringStatus=e).response&&null!=g_MonitoringStatus.response.WifiStatus&&void 0!==g_MonitoringStatus.response.WifiStatus&&""!=g_MonitoringStatus.response.WifiStatus&&WIFI_STATUS_ON==g_MonitoringStatus.response.WifiStatus){var t=object2xml("request",g_handover_setting);saveAjaxData("api/wlan/handover-setting",t,(function(i){var e=xml2object(i);g_getHandover="error"==e.type?e.error.code:""}),{sync:!0}),g_getHandover==ERROR_SYSTEM_BUSY?setTimeout((function(){getHandoverSuccessSetting()}),1e3):(WIFI_PREFER==g_handover_setting.Handover?(g_status_wanpolicy=WIFI_PREFER,index_clickTrunOnBtn()):(g_status_wanpolicy=G3_PREFER,index_clickTurnOffBtn()),closeWaitingDialog(),g_manualflag=!1)}else setTimeout((function(){getHandoverSuccessSetting()}),1e3)}),{errorCB:function(){setTimeout((function(){getHandoverSuccessSetting()}),1e3)},sync:!0})}function scanWifi(){$("#scan_div").show(),$("#wifi_scan").show(),$("#wifi_content").show(),$("#wifioffload_setting").hide(),$("#wifi_no_ap").hide(),button_enable("addWiFI_button","0"),button_enable("scan_button","0"),g_buttonEnabled=!1;var i=object2xml("request",g_wifiscan);saveAjaxData("api/wlan/wifiscan",i,(function(i){var e=xml2object(i);isAjaxReturnOK(e)?(g_wifi_ap_info_list=[],checkWifiScanStatue()):ERROR_SYSTEM_BUSY==e.error.code&&(showInfoDialog(common_system_busy),$("#wifi_scan").hide(),$("#wifi_no_ap").show(),button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)}))}function checkWifiScanStatue(){getAjaxData("api/wlan/wifiscan",(function(i){var e=xml2object(i);"response"==e.type?WIFI_SCAN_END==e.response.Wifiscan?getWiFiAPinfo():WIFI_SCANING==e.response.Wifiscan?setTimeout((function(){checkWifiScanStatue()}),1e3):$("#wifi_scan").hide():($("#wifi_scan").hide(),$("#wifi_no_ap").show(),$("#wifioffload_setting").hide(),g_wifiscanresult=[],button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)}))}function getWiFiAPinfo(){getAjaxData("api/wlan/wifiscanresult",(function(i){var e=xml2object(i);"response"==e.type?(g_wifiscanresult=e.response.SsidLists.SsidList,$.isArray(g_wifiscanresult)||void 0!==g_wifiscanresult&&null!=g_wifiscanresult&&""!=g_wifiscanresult?(setWiFiList(),g_buttonEnabled=!0,CheckWiFiConnectStatue(),$("#wifi_scan").hide(),$("#wifi_no_ap").hide(),$("#wifioffload_setting").show()):($("#wifi_scan").hide(),$("#wifi_no_ap").show(),$("#wifioffload_setting").hide(),g_wifiscanresult=[],button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)):($("#wifi_scan").hide(),$("#wifi_no_ap").show(),$("#wifioffload_setting").hide(),g_wifiscanresult=[],button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)}))}function CheckWiFiConnectStatue(){if(1!=g_sync_connecting){null!=G_StationStatus&&""!=G_StationStatus||getAjaxData("api/wlan/station-information",(function(i){var e=xml2object(i);G_StationStatus=e}),{sync:!0});var i=G_StationStatus;if("response"==i.type){if(g_wifi_ap_info_list.length>0&&(""==i.response.NetworkName||null==i.response.NetworkName?g_wifi_ap_info_list[0].WifiConnectStatue=WIFI_Not_CONNECTED:G_MonitoringStatus.response.WifiConnectionStatus==WIFI_CONNECTED&&g_wifi_ap_info_list[0].WifiSsid==i.response.NetworkName&&g_wifi_ap_info_list[0].WifiSecMode==i.response.CurrentSecMode?g_wifi_ap_info_list[0].WifiSignal=i.response.SignalStrength:i.response.NetworkName==g_wifi_ap_info_list[0].WifiSsid&&g_wifi_ap_info_list[0].WifiSecMode==i.response.CurrentSecMode||(g_wifi_ap_info_list[0].WifiConnectStatue=WIFI_Not_CONNECTED,moveToTopOfApLsit(i.response.NetworkName,i.response.CurrentSecMode),g_isFind&&G_MonitoringStatus.response.WifiConnectionStatus==WIFI_CONNECTED&&(g_wifi_ap_info_list[0].WifiSignal=i.response.SignalStrength)),g_isNewProfile&&WIFI_CONNECTING!=G_MonitoringStatus.response.WifiConnectionStatus&&WIFI_CONNECTED!=G_MonitoringStatus.response.WifiConnectionStatus&&1!=g_isWrongPassWord&&(g_isNewProfile=!1,removeFromApinfoList(0),g_wifi_ap_info_list.length<=0&&($("#wifi_no_ap").show(),$("#wifioffload_setting").hide(),button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0))),g_stationInfoFlag)return void(g_stationInfoFlag=!1);changeWiFiList(i.response.NetworkName,i.response.CurrentSecMode)}else"error"==i.type&&(ERROR_WRONG_PASSWORD==i.error.code?(g_isWrongPassWord=!0,g_ssid_error_name=i.error.message.substring(0,i.error.message.lastIndexOf(",")),g_ssid_error_mode=i.error.message.substring(i.error.message.lastIndexOf(",")+1,i.error.message.length),-1==g_current_index?(moveToTopOfApLsit(g_ssid_error_name,g_ssid_error_mode),creatWifiList(),g_current_index=0,g_isFind&&showPasswrodDiag(),g_isFind=!1):showPasswrodDiag()):ERROR_WISPR_PASSWORD==i.error.code&&wisprSetting(g_current_index))}}function setWiFiList(){if(g_wifi_ap_info_list=[],$.isArray(g_wifiscanresult))$.each(g_wifiscanresult,(function(i){var e={WifiSsid:g_wifiscanresult[i].WifiSsid,WifiSignal:g_wifiscanresult[i].WifiSignal,WifiAuthMode:g_wifiscanresult[i].WifiAuthMode,WifiSecMode:g_wifiscanresult[i].WifiSecMode,WifiNeedPassword:"1"==g_wifiscanresult[i].WifiNeedPassword,WifiConnectStatue:WIFI_Not_CONNECTED,wifiwisprenable:g_wifiscanresult[i].wifiwisprenable,wifiwispruser:g_wifiscanresult[i].wifiwispruser,profileenable:g_wifiscanresult[i].profileenable,wifiwispruwd:g_wifiscanresult[i].wifiwispruwd};g_wifi_ap_info_list.push(e)}));else{var i={WifiSsid:g_wifiscanresult.WifiSsid,WifiSignal:g_wifiscanresult.WifiSignal,WifiAuthMode:g_wifiscanresult.WifiAuthMode,WifiSecMode:g_wifiscanresult.WifiSecMode,WifiNeedPassword:"1"==g_wifiscanresult.WifiNeedPassword,WifiConnectStatue:WIFI_Not_CONNECTED,wifiwisprenable:g_wifiscanresult.wifiwisprenable,wifiwispruser:g_wifiscanresult.wifiwispruser,profileenable:g_wifiscanresult.profileenable,wifiwispruwd:g_wifiscanresult.wifiwispruwd};g_wifi_ap_info_list.push(i)}}function addToApinfoList(i){g_wifi_ap_info_list.unshift(i)}function removeFromApinfoList(i){g_wifi_ap_info_list.splice(i,1)}function moveToTopOfApLsit(i,e){for(var t=0,n=-1;t<g_wifi_ap_info_list.length;t++)if(i==g_wifi_ap_info_list[t].WifiSsid&&e==g_wifi_ap_info_list[t].WifiSecMode){n=t;break}if(-1!=n){var o=g_wifi_ap_info_list.splice(n,1);g_wifi_ap_info_list.unshift(o[0]),g_isFind=!0}}function changeWiFiList(i,e){g_wifi_ap_info_list.length>0&&(moveToTopOfApLsit(i,e),g_isFind?g_wifi_ap_info_list[0].WifiConnectStatue=G_MonitoringStatus.response.WifiConnectionStatus:null!=i&&""!=i?addToApinfoList({WifiSsid:G_StationStatus.response.NetworkName,WifiSignal:G_StationStatus.response.SignalStrength,WifiAuthMode:null,WifiSecMode:G_StationStatus.response.CurrentSecMode,WifiNeedPassword:!1,WifiConnectStatue:G_MonitoringStatus.response.WifiConnectionStatus}):g_wifi_ap_info_list[0].WifiConnectStatue=WIFI_Not_CONNECTED,g_isFind=!1,creatWifiList())}function creatWifiList(){for(var i="",e=0,t="";e<g_wifi_ap_info_list.length;e++){t=setWifiSignal(g_wifi_ap_info_list[e].WifiSignal);var n="wifi_ap_"+e,o="";switch(g_wifi_ap_info_list[e].WifiConnectStatue){case WIFI_CONNECTING:o=dialup_label_connecting;break;case WIFI_CONNECTED:o=dialup_label_connected;break;default:o=SECURITY_MODE_NONE==g_wifi_ap_info_list[e].WifiSecMode?wlan_label_open:wifi_label_Secure_mode.replace("%s",XSSResolveCannotParseChar(g_wifi_ap_info_list[e].WifiSecMode))}var _;_=g_wifi_ap_info_list[e].WifiSecMode==SECURITY_MODE_NONE?"../res/station_"+t+".png":"../res/stationkey_"+t+".gif",void 0!==g_wifi_ap_info_list[e].profileenable&&CURRENT_PROFILEENABLE!=g_wifi_ap_info_list[e].profileenable?i+="<tr class='wifi_ap profile_disable_line' id='"+n+"'>":i+="<tr class='wifi_ap' id='"+n+"'>",i+="<td width='240'>",i+="<div class='wifiName'><span>"+replaceSpaceOther(XSSResolveCannotParseChar(g_wifi_ap_info_list[e].WifiSsid))+"</span></div>",i+="<div>"+o+"</div>",i+="</td>",i+="<td><div class='wifi_signal' ><img  onload = 'fixPNG(this)'  src = "+_+" /></div>",i+="</td>",void 0!==g_wifi_ap_info_list[e].profileenable&&CURRENT_PROFILEENABLE!=g_wifi_ap_info_list[e].profileenable?i+="<td><div class = 'profile_disable'>"+common_disabled+"</div></td>":i+="<td></td>",i+="</tr>"}$(".wifioffload_settings").html(i),g_wifi_ap_info_list.length>0&&WIFI_CONNECTING==g_wifi_ap_info_list[0].WifiConnectStatue?(g_isConnecting=!0,$("#scan_button").removeClass("mouse_on"),button_enable("scan_button","0"),$("#addWiFI_button").removeClass("mouse_on"),button_enable("addWiFI_button","0"),button_enable("wifi_connect","0")):(g_isConnecting=!1,1==g_buttonEnabled&&(button_enable("scan_button","1"),button_enable("addWiFI_button","1"),button_enable("wifi_connect","1")))}function showConnectDialog(i){var e="";e+="        <div class='addwifi_dialog_table'>",e+="               <table width='370' border='0' cellpadding='0' cellspacing='0' class='new_profile'>",e+="               <tr id='ssid_div'>",e+="                   <td hight='32' colspan='2'><p>"+replaceSpaceOther(g_wifi_ap_info_list[i].WifiSsid)+"</p></td>",e+="               </tr>",e+="               </table>",e+="               <table width='370' border='0' cellpadding='0' cellspacing='0' class='new_profile'>",e+="               <tr id='authentication_div'>",e+="                   <td width='180'><p>"+wlan_label_authentication+common_colon+"</p></td>",e+="                   <td><span>"+(SECURITY_MODE_NONE==g_wifi_ap_info_list[i].WifiSecMode?wlan_label_open:g_wifi_ap_info_list[i].WifiSecMode)+"</span></td>",e+="               </tr>",g_wifi_ap_info_list[i].WifiNeedPassword&&(e+="               <tr id='password_wrapper'>",e+="                   <td width='130'><p>"+common_password+common_colon+"</p></td>",e+="                   <td><span><input type='password'  autocomplete='off' size='25' id='wifi_password' maxlength='64'/></span></td>",e+="               </tr>",e+="               <tr id='connect_password_show'>",e+="                   <td width='130'>&nbsp;</td>",e+="                   <td><p><input type='checkbox'  id='check_wpa_psk' style='vertical-align:middle;' /> "+common_show_password+"</p></td>",e+="               </tr>"),e+="               </table>",e+="        </div>",showDialog(common_confirm,e,common_connect,"pop_connect",common_cancel,"pop_cancel"),$("#wifi_password").focus(),g_wifi_ap_info_list[i].WifiNeedPassword,$(".addwifi_dialog_table").css({height:"auto"})}function addNewWifi(){isButtonEnable("addWiFI_button")&&showAddWiFiDialog()}function showAddWiFiDialog(){var i="";i+="        <div class='addwifi_dialog_table'>",i+="               <div id='ssid_div'>",i+="                   <p>"+wlan_label_ssid+common_colon+"</p>",i+="                   <span><input type='text' size='25'  id='ssid_input' maxlength='32'/></span>",i+="               </div>",i+="               <div id='authentication_div'>",i+="               <p>"+IDS_wifi_label_security+common_colon+"</p>",i+="                   <span>",i+="                       <select name='authentication_mode' id='pop_authmode'>",i+="                        <option value='"+SECURITY_MODE_NONE+"'>"+IDS_wlan_label_open+"</option>",i+="                        <option value='"+SECURITY_MODE_WEP+"'>"+wlan_label_wep+"</option>",i+="                        <option value='"+SECURITY_MODE_WPA_WPA2_PSK+"'>"+wlan_label_wpa_wpa2_psk+"</option>",i+="                       </select>",i+="                   </span>",i+="               </div>",i+="               <div id='password_wrapper'>",i+="                  <p>"+common_password+common_colon+"</p>",i+="                   <span><input type='password' autocomplete='off' size='25'  id='add_wifi_password' maxlength='64'/></span>",i+="               </div>",i+="               <div id='password_show'>",i+='                  <p><input type="checkbox"  id="check_wpa_psk" style="vertical-align:middle;"/> '+common_show_password+"</p>",i+="               </div>",i+="         </div>",showDialog(wifi_label_addwifi_network,i,common_connect,"pop_save",common_cancel,"pop_cancel"),$("#password_wrapper").hide(),$("#password_show").hide(),$("#ssid_input").focus(),$("#ssid_input").keyup((function(){checkInputSsidNameValid($(this).attr("id"),$.trim($(this).val()))}))}function wifiProfile_validation_checkName(i,e,t){clearAllErrorLabel();var n,o=$.trim($("#ssid_input").val());return n="1"==g_wifiFeatureSwitch.chinesessid_enable?checkInputSsidNameValid("ssid_input",o):validateSsid(o),common_ok!=n?(showErrorUnderTextbox("ssid_input",n),$("#ssid_input").focus(),$("#ssid_input").select(),!1):!!checkWifiSecurity(e,t,"add_wifi_password")}function showErrorUnderTextField(i,e){$.each($(".pro_wrong"),(function(i){$(this).remove()})),$("#"+i).focus(),$("#password_wrapper").after("<tr class='pro_wrong'><td>&nbsp;</td><td colspan='2' class='pro_wrong_td clr_red' id='temp_wrong'>&nbsp;</td></tr>"),$("#temp_wrong").attr("id","pro_name_wrong"),$("#pro_name_wrong").html(e),e.length,$(".addwifi_dialog_table").css({height:"auto"})}function showPasswrodDiag(){var i="";i+="        <div class='password_dialog_table'>",i+="               <table width='370' border='0' cellpadding='0' cellspacing='0' class='new_profile'>",i+="               <div id='intput_password_wrapper'>",i+="                  <tr><td width='20'>&nbsp;</td><td><p>"+(g_isWrongPassWord?wifi_label_wrong_passwrod_notice:wifi_label_passwrod_notice)+"</p></td></tr>",i+="                   <tr id='password_wrapper'><td width='20'>&nbsp;</td><td><p><span><input type='password' autocomplete='off' size='25' id='wifi_password' maxlength='64'/></span></p></td></tr>",i+="                   <tr ><td width='20'>&nbsp;</td><td><div id='reenter_password_show'><p><input type='checkbox'  id='check_wpa_psk' style='vertical-align:middle;'/> "+common_show_password+"</p></div></td></tr>",i+="               </div>",i+="               </table>",i+="        </div>",showDialog(wlan_lable_notice,i,common_connect,"pop_connect",common_cancel,"pop_cancel"),$("#wifi_password").focus()}function getWiFiPriorityAPinfo(){getAjaxData("api/wlan/wifiprofile",(function(i){var e=xml2object(i);"response"==e.type&&void 0!==e.response.SsidLists.SsidList?(g_wifipriorityscanresult=CreateArray(e.response.SsidLists.SsidList),($.isArray(g_wifipriorityscanresult)||void 0!==g_wifipriorityscanresult&&null!=g_wifipriorityscanresult&&""!=g_wifipriorityscanresult)&&setWiFiPriorityList()):g_wifipriorityscanresult=[]}),{sync:!0})}function setWiFiPriorityList(){if(g_priority_wifi_ap_info_list=[],$.isArray(g_wifipriorityscanresult))$.each(g_wifipriorityscanresult,(function(i){var e={WifiSsid:g_wifipriorityscanresult[i].WifiSsid,WifiSecMode:g_wifipriorityscanresult[i].WifiSecMode,Preset:g_wifipriorityscanresult[i].Preset,Index:g_wifipriorityscanresult[i].Index,Order:g_wifipriorityscanresult[i].Order};g_priority_wifi_ap_info_list.push(e)}));else{var i={WifiSsid:g_wifipriorityscanresult.WifiSsid,WifiSecMode:g_wifipriorityscanresult.WifiSecMode,Preset:g_wifipriorityscanresult.Preset,Index:g_wifipriorityscanresult.Index,Order:g_wifipriorityscanresult.Order};g_priority_wifi_ap_info_list.push(i)}}function in_array(i,e,t,n){var o;if(i.length<n)return!0;for(o=0;o<i.length;o++)if(i[o].WifiSsid==e&&i[o].WifiSecMode==t)return!0;return!1}function do_connect(){if(g_current_index=getWiFiIndex(g_current_id),g_wifi_ap_info_list[g_current_index].WifiNeedPassword){var i=getWiFiIndex(g_current_id);WIFI_CONNECTED!=g_wifi_ap_info_list[i].WifiConnectStatue&&WIFI_CONNECTING!=g_wifi_ap_info_list[i].WifiConnectStatue&&showConnectDialog(i)}else{disconnectConnectedWiFi();var e={WifiSsid:g_wifi_ap_info_list[g_current_index].WifiSsid,WifiAuthMode:g_wifi_ap_info_list[g_current_index].WifiAuthMode,WifiSecMode:g_wifi_ap_info_list[g_current_index].WifiSecMode,WifiAuthSecret:""};g_isNewProfile=!1,setProfileSetting(e,g_current_index)}}function wisprSetting(i){var e="";e+="        <div class='addwifi_dialog_table'>",e+="               <table width='370' border='0' cellpadding='0' cellspacing='0' class='new_profile'>",e+="               <tr id='ssid_div'>",e+="                   <td hight='32' colspan='2'><p>"+replaceSpaceOther(g_wifi_ap_info_list[i].WifiSsid)+"</p></td>",e+="               </tr>",e+="               </table>",e+="               <table width='370' border='0' cellpadding='0' cellspacing='0' class='new_profile'>",e+="               <tr id='authentication_div'>",e+="                   <td width='180'><p>"+wlan_label_authentication+common_colon+"</p></td>",e+="                   <td><span>"+(SECURITY_MODE_NONE==g_wifi_ap_info_list[i].WifiSecMode?wlan_label_open+" "+common_comma+" "+IDS_wlan_wispr_title:g_wifi_ap_info_list[i].WifiSecMode+" "+common_comma+" "+IDS_wlan_wispr_title)+"</span></td>",e+="               </tr>",e+="               <tr>",e+="                   <td width='130'><p>"+dialup_label_user_name+common_colon+"</p></td>",e+="                   <td><span><input type='username' size='25'  id='wispr_username' /></span></td>",e+="               </tr>",e+="               <tr>",e+="                   <td width='130'><p>"+common_password+common_colon+"</p></td>",e+="                   <td><span><input type='password'  autocomplete='off' size='25' id='wispr_password' /></span></td>",e+="               </tr>",e+="               <tr id='connect_password_show'>",e+="                   <td width='130'>&nbsp;</td>",e+="                   <td><p><input type='checkbox'  id='check_wpa_psk' style='vertical-align:middle;' /> "+common_show_password+"</p></td>",e+="               </tr>",e+="               </table>",e+="        </div>",showDialog(common_confirm,e,common_save,"wispr_Save",common_cancel,"pop_cancel"),$("#wispr_username").focus(),$(".addwifi_dialog_table").css({height:"auto"})}function wispr_apply(){var i=$.trim($("#wispr_username").val()),e=$.trim($("#wispr_password").val());if(isButtonEnable("wispr_Save")&&wispr_validInput({Username:i,Password:e},"wispr_username","wispr_password")){g_isWrongPassWord||(g_current_index=getWiFiIndex(g_current_id));var t={WifiSsid:wifiSsidResolveCannotParseChar(g_wifi_ap_info_list[g_current_index].WifiSsid),WifiAuthMode:g_wifi_ap_info_list[g_current_index].WifiAuthMode,WifiSecMode:g_wifi_ap_info_list[g_current_index].WifiSecMode,WifiAuthSecret:wifiSsidResolveCannotParseChar(g_wifi_ap_info_list[g_current_index].WifiAuthSecret),wifiwispruser:i,wifiwisprpwd:e},n=object2xml("request",t);promag_cancel(),saveAjaxData("api/wlan/wifiaddprofile",n,(function(i){var e=xml2object(i);isAjaxReturnOK(e)?do_connect():ERROR_SYSTEM_BUSY==e.error.code&&(showInfoDialog(common_system_busy),$("#wifi_scan").hide(),$("#wifi_no_ap").show(),button_enable("addWiFI_button","1"),button_enable("scan_button","1"),g_buttonEnabled=!0)}),{enc:!0})}}function checkOffloadScanEnabled(){if(checkValueIsNull(G_cradleStationStatus))if(g_module.cradle_enabled&&CRADLE_NETLINE_EXIST==G_cradleStationStatus.cradlestatus&&ETHERNET_LAN_MODE!=G_cradleStationStatus.connectionmode){var i=IDS_function_disabled.replace("%s1","cradle").replace("%s2","offload");showInfoDialog(i,!1,disableEntirePage)}else scanWifi();else setTimeout(checkOffloadScanEnabled,50)}function getCradleStatus(){g_module.cradle_enabled&&getAjaxData("api/cradle/status-info",(function(i){var e=xml2object(i);"response"==e.type&&(G_cradleStationStatus=e.response)}),{sync:!0})}function isCradleStatusOK(){if(getCradleStatus(),g_module.cradle_enabled&&CRADLE_NETLINE_EXIST==G_cradleStationStatus.cradlestatus&&ETHERNET_LAN_MODE!=G_cradleStationStatus.connectionmode){var i=IDS_function_disabled.replace("%s1","cradle").replace("%s2","offload");return showInfoDialog(i,!1,disableEntirePage),button_enable("scan_button","0"),$("#wifi_content").hide(),$("#addWiFI_button").hide(),g_buttonEnabled=!1,!1}return!0}main_executeBeforeDocumentReady(),$(document).ready((function(){$("#wispr_Save").live("click",(function(){wispr_apply()})),$("#check_wpa_psk").live("click",(function(){showPassword("wispr_password","check_wpa_psk")})),getWiFiPriorityAPinfo(),$(".wifi_ap").live("click",(function(){if(isCradleStatusOK()&&(getWiFiPriorityAPinfo(),WIFI_CONNECTING!=G_MonitoringStatus.response.WifiConnectionStatus)){var i=getWiFiIndex(g_current_id=this.id);if(void 0===g_wifi_ap_info_list[i].profileenable||CURRENT_PROFILEENABLE==g_wifi_ap_info_list[i].profileenable){var e=g_wifi_ap_info_list[i].WifiSsid,t=g_wifi_ap_info_list[i].WifiSecMode;WifiWisprEnable=g_wifi_ap_info_list[i].wifiwisprenable;var n=g_wifi_ap_info_list[i].wifiwispruser,o=g_wifi_ap_info_list[i].wifiwisprpwd;if(refreshNeedPassWord(e,t,i),checkLeftMenu(g_PageUrlTree.settings.internet.wifipriority)&&!in_array(g_priority_wifi_ap_info_list,e,t,WiFi_PRIORITY_NUM)){var _="SSID:"+replaceSpaceOther(g_priority_wifi_ap_info_list[g_priority_wifi_ap_info_list.length-1].WifiSsid)+" and SecMode:"+g_priority_wifi_ap_info_list[g_priority_wifi_ap_info_list.length-1].WifiSecMode;return showConfirmDialog(IDS_wifi_priority_delete_ssid.replace("%s",_),do_connect,(function(){})),!1}if(void 0!==g_wifi_ap_info_list[i].profileenable&&""!=g_wifi_ap_info_list[i].profileenable&&WifiWisprEnable==CURRENT_WISPRENABLE&&(""==n||""==o))return wisprSetting(i),!1;WIFI_CONNECTED!=g_wifi_ap_info_list[i].WifiConnectStatue&&WIFI_CONNECTING!=g_wifi_ap_info_list[i].WifiConnectStatue&&showConnectDialog(i)}}})),$("#pop_connect").live("click",(function(){if(isButtonEnable("pop_connect")){if(!isCradleStatusOK())return $(".dialog").remove(),void $(".login_dialog").remove();if(g_isWrongPassWord||(g_current_index=getWiFiIndex(g_current_id)),g_isWrongPassWord||g_wifi_ap_info_list[g_current_index].WifiNeedPassword){var i=$("#wifi_password").val();checkWifiSecurity(i,g_wifi_ap_info_list[g_current_index].WifiSecMode,"wifi_password")&&setWifi(i)}else setWifi("")}})),addStatusListener("CheckWiFiConnectStatue()"),getHandoverSetting(),$("#turnOff_button").live("click",(function(){isButtonEnable("turnOff_button")&&isCradleStatusOK()&&(g_handover_setting.Handover="0",$("#turnOff_button").removeClass("mouse_on"),button_enable("turnOff_button","0"),setHandoverSetting())})),$("#turnOn_button").live("click",(function(){isButtonEnable("turnOn_button")&&isCradleStatusOK()&&(g_handover_setting.Handover="2",$("#turnOn_button").removeClass("mouse_on"),button_enable("turnOn_button","0"),setHandoverSetting())})),$("#pop_cancel").live("click",(function(){isButtonEnable("pop_cancel")&&(g_isNewProfile&&(removeFromApinfoList(0),g_isNewProfile=!1),g_isWrongPassWord=!1,promag_cancel())})),$("#pop_authmode").live("change",(function(){SECURITY_MODE_NONE==this.value||SECURITY_MODE_WPA_WPA2_EAP==this.value?($("#password_wrapper").hide(),$("#password_show").hide(),$(".addwifi_dialog_table").css({height:"auto"})):(clearAllErrorLabel(),$("#password_wrapper").show(),$("#password_show").show(),$(".addwifi_dialog_table").css({height:"auto"}))})),$("#password_show").live("click",(function(){showPassword("add_wifi_password","check_wpa_psk")})),$("#connect_password_show").live("click",(function(){showPassword("wifi_password","check_wpa_psk")})),$("#reenter_password_show").live("click",(function(){showPassword("wifi_password","check_wpa_psk")})),$("#pop_save").live("click",(function(){if(isButtonEnable("pop_save")){if(!isCradleStatusOK())return $(".dialog").remove(),void $(".login_dialog").remove();getWiFiPriorityAPinfo();var i=$.trim($("#ssid_input").val()),e=$("#pop_authmode").val(),t=$("#add_wifi_password").val(),n=-1,o=0;if(wifiProfile_validation_checkName(i,t,e)){disconnectConnectedWiFi();for(var _={WifiSsid:i,WifiAuthMode:"",WifiSecMode:e,WifiAuthSecret:t},s={WifiSsid:i,WifiSignal:"1",WifiAuthMode:"",WifiSecMode:e,WifiNeedPassword:!1,WifiConnectStatue:WIFI_CONNECTING};o<g_wifi_ap_info_list.length;o++)if(i==g_wifi_ap_info_list[o].WifiSsid&&e==g_wifi_ap_info_list[o].WifiSecMode){n=o;break}function a(){-1!=n?setProfileSetting(_={WifiSsid:g_wifi_ap_info_list[n].WifiSsid,WifiAuthMode:g_wifi_ap_info_list[n].WifiAuthMode,WifiSecMode:g_wifi_ap_info_list[n].WifiSecMode,WifiAuthSecret:t},n):(g_isNewProfile=!0,addToApinfoList(s),g_current_index=0,setProfileSetting(_,0)),$("#wifi_scan").hide(),$("#wifi_no_ap").hide(),$("#wifioffload_setting").show(),promag_cancel()}if(checkLeftMenu(g_PageUrlTree.settings.internet.wifipriority)&&!in_array(g_priority_wifi_ap_info_list,s.WifiSsid,s.WifiSecMode,WiFi_PRIORITY_NUM)){promag_cancel();var r="SSID:"+replaceSpaceOther(g_priority_wifi_ap_info_list[g_priority_wifi_ap_info_list.length-1].WifiSsid)+" and SecMode:"+g_priority_wifi_ap_info_list[g_priority_wifi_ap_info_list.length-1].WifiSecMode;return showConfirmDialog(IDS_wifi_priority_delete_ssid.replace("%s",r),(function(){a()}),(function(){})),!1}a()}}})),$("#wifi_disconnect").live("click",(function(){isButtonEnable("wifi_disconnect")&&disconnectWiFi(0)})),$("#scan_button").live("click",(function(){isButtonEnable("scan_button")&&isCradleStatusOK()&&scanWifi()})),$("#addWiFI_button").live("click",(function(){isCradleStatusOK()&&addNewWifi()})),$(".dialog_close_btn, .pop_Cancel").live("click",(function(){g_isNewProfile&&(removeFromApinfoList(0),g_isNewProfile=!1),g_isWrongPassWord=!1})),$(".dialog_close_btn").live("click",(function(){g_isNewProfile&&(removeFromApinfoList(0),g_isNewProfile=!1)}))}));
