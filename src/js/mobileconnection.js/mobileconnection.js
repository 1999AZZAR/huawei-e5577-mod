var MIN_IDLE_TIME=30,MAX_IDLE_TIME=7200,MACRO_DISPLAY=1,g_connectionData=null,g_profileData=null,CONNECTMODE_AUTO=0,CONNECTMODE_MANUAL=1,CONNECTMODE_ONDEMAND=2,IDLE_TIME_ENABLE=1,IDLE_TIME_DISABLE=0,g_connect_config="",g_idle_time_enable=0,g_quicksetup_saveDataOK=!1,g_mobile_dataswitch=null,vsim_enabled=0,moduleSwitch=null,g_autodial_switch=null;function setRoamStatus(e){e=0==e?1:0,$("input[name='roam_switch']").eq(e).attr("checked",!0)}function setConnectionStatus(){CONNECTMODE_MANUAL==$("#select_connection_mode").val()&&null==g_mobile_dataswitch?($("#roam_open").hide(),$("#ondemand_connect").hide()):(1==vsim_enabled?$("#roam_open").hide():$("#roam_open").show(),IDLE_TIME_ENABLE==g_idle_time_enable&&0==g_module.ipv6_enabled?$("#ondemand_connect").show():$("#ondemand_connect").hide(),1==g_connectionData.pdp_always_on?($("#select_max_idle_time option[value='0']").remove(),$("#select_max_idle_time").append('<option value = "0">'+IDS_dialup_always_on+"</option>"),"0"==g_connectionData.MaxIdelTime||"300"==g_connectionData.MaxIdelTime||"600"==g_connectionData.MaxIdelTime||"1200"==g_connectionData.MaxIdelTime||"7200"==g_connectionData.MaxIdelTime?$("#select_max_idle_time").val(g_connectionData.MaxIdelTime):$("#select_max_idle_time").val("300")):"300"==g_connectionData.MaxIdelTime||"600"==g_connectionData.MaxIdelTime||"1200"==g_connectionData.MaxIdelTime||"7200"==g_connectionData.MaxIdelTime?$("#select_max_idle_time").val(g_connectionData.MaxIdelTime):$("#select_max_idle_time").val("300"),setRoamStatus(parseInt(g_connectionData.RoamAutoConnectEnable,10)))}function getMobile_dataswitch(){getAjaxData("api/dialup/mobile-dataswitch",(function(e){var n=xml2object(e);"response"==n.type&&("1"==(g_mobile_dataswitch=n.response).dataswitch?index_clickTrunOnBtn(!0):index_clickTrunOnBtn(!1))}),{sync:!0})}function initPage(){getAjaxData("api/dialup/dialup-feature-switch",(function(e){var n=xml2object(e);"response"==n.type&&(g_autodial_switch=n.response.auto_dial_enabled)}),{sync:!0}),g_module.dataswitch_enabled?(displaymobile_data(!0),getMobile_dataswitch(),"1"==g_autodial_switch&&$("#auto_dial").show()):displaymobile_data(!1),getConfigData("config/dialup/connectmode.xml",(function(e){var n=xml2object(e);"config"==n.type&&($("#select_connection_mode").empty(),g_idle_time_enable=n.config.idle_time_enabled,1==(g_connect_config=n.config.ConnectMode).Auto&&$("#select_connection_mode").append("<option value='0'><li><a href='javascript:void(0);'>"+common_auto+"</a></li></option>"),1==g_connect_config.Manual&&$("#select_connection_mode").append("<option value='1'><li><a href='javascript:void(0);'>"+common_manual+"</a></li></option>"),1==g_connect_config.Auto&&1==g_connect_config.Manual?($("#select_connection_mode").show(),$("#text_connection_mode").hide()):($("#select_connection_mode").hide(),$("#text_connection_mode").text($("#select_connection_mode").find("option:selected").text()),$("#text_connection_mode").show()))}),{sync:!0}),getAjaxData("api/dialup/connection",(function(e){var n=xml2object(e);"response"==n.type&&(g_connectionData=n.response,MACRO_DISPLAY==g_connect_config.Auto?MACRO_DISPLAY==g_connect_config.Manual?$("#select_connection_mode").val(g_connectionData.ConnectMode):$("#select_connection_mode").val(CONNECTMODE_AUTO):MACRO_DISPLAY==g_connect_config.Manual?$("#select_connection_mode").val(CONNECTMODE_MANUAL):$("#select_connection_mode").attr("disabled","disabled"),$("#enable_auto_dial_switch").attr("checked",1==g_connectionData.auto_dial_switch))}),{sync:!0}),getAjaxData("api/global/module-switch",(function(e){var n=xml2object(e);"response"==n.type&&(moduleSwitch=n.response,vsim_enabled=moduleSwitch.vsim_enabled)}),{sync:!0}),setConnectionStatus()}function displaymobile_data(e){e&&$(".mobile_data").show(),$(".no_mobile_data").show(),$("#select_connection_mode").bind("change",(function(){setConnectionStatus()}))}function index_clickTrunOnBtn(e){if("new"==webui_mode)var n='<div id="mobilenetwork_turnOn_button" class="new_switch_bg"><div id="new_switch_point"></div></div>',t='<div id="mobilenetwork_turnOff_button" class="new_switch_bg_on"><div id="new_switch_point"></div></div>';e?"new"==webui_mode?$("#mobilenetwork_switch_button").html(t):$("#mobilenetwork_switch_button").html(create_button_html(common_turn_off,"mobilenetwork_turnOff_button")):"new"==webui_mode?$("#mobilenetwork_switch_button").html(n):$("#mobilenetwork_switch_button").html(create_button_html(common_turn_on,"mobilenetwork_turnOn_button")),ieRadiusBorder(),"material"==webui_mode&&materializeButtons()}function changeMobile_DataSwitch(){g_mobile_dataswitch.dataswitch="1"==g_mobile_dataswitch.dataswitch?"0":"1";var e=object2xml("request",g_mobile_dataswitch);saveAjaxData("api/dialup/mobile-dataswitch",e,(function(e){var n=xml2object(e);isAjaxReturnOK(n)?(getMobile_dataswitch(),showInfoDialog(common_success)):showInfoDialog(common_fail)}))}function postData(){if(g_quicksetup_saveDataOK=!0,g_connectionData.ConnectMode=$("#select_connection_mode").val(),g_connectionData.RoamAutoConnectEnable=$("[name='roam_switch']:checked").val(),0!=$("#ondemand_connect").is(":visible")&&(g_connectionData.MaxIdelTime=$.trim($("#select_max_idle_time").val())),g_connectionData.auto_dial_switch=$("#enable_auto_dial_switch").get(0).checked?1:0,button_enable("apply","0"),g_module.ap_station_enabled&&CONNECTMODE_MANUAL==g_connectionData.ConnectMode){var e=object2xml("request",{Handover:0});saveAjaxData("api/wlan/handover-setting",e,(function(e){var n=xml2object(e);isAjaxReturnOK(n)||(g_quicksetup_saveDataOK=!1)}))}var n=object2xml("request",g_connectionData);saveAjaxData("api/dialup/connection",n,(function(e){var n=xml2object(e);isAjaxReturnOK(n)?(showInfoDialog(common_success),button_enable("apply","0")):(showInfoDialog(common_fail),initPage())}))}function onApply(){isButtonEnable("apply")&&(clearAllErrorLabel(),(CONNECTMODE_AUTO==$("#select_connection_mode").val()||null!=g_mobile_dataswitch)&&$("[name='roam_switch']:checked").val()>0?showConfirmDialog(dialup_hint_roam_auto_connect,postData,(function(){})):showConfirmDialog(firewall_hint_submit_list_item,postData,(function(){})),$("#pop_confirm").click((function(){button_enable("apply","0")})))}redirectOnCondition(null,"mobileconnection"),$(document).ready((function(){initPage(),1==vsim_enabled&&$("#roam_open").css("display","none"),button_enable("apply","0"),$("#apply").bind("click",onApply),$("input,select").bind("change input paste cut keydown",(function(e){MACRO_KEYCODE!=e.keyCode&&button_enable("apply","1")})),$("#mobilenetwork_turnOn_button").live("click",changeMobile_DataSwitch),$("#mobilenetwork_turnOff_button").live("click",changeMobile_DataSwitch),$("#enable_auto_dial_switch").click((function(){button_enable("apply","1")})),addStatusListener("getMobile_dataswitch()")}));
