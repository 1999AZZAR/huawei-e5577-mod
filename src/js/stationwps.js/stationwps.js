var PBC_CONNECT_FAILED="3",PBC_CONNECTING="4",PBC_CONNECT_SUCCESS="5",PBC_GET_STATUS_INTERVAL=3e3,PBC_WAITING_TIMEOUT=18e4,pbcGetStatusTimer=null,pbcWaitingTimer=null,pbcOffloadTimer=null,g_hasPopInfoDialog=!1,g_hasWaitingDialog=!1;function find_wifi_offload_status(){getAjaxData("api/wlan/handover-setting",(function(t){"2"==xml2object(t).response.Handover?(button_enable("button_connection","1"),g_hasPopInfoDialog=!1):(g_hasWaitingDialog&&(closeWaitingDialog(),g_hasWaitingDialog=!1,clearTimeout(pbcWaitingTimer),clearTimeout(pbcGetStatusTimer),startLogoutTimer(),showInfoDialog(IDS_wps_connection)),g_hasPopInfoDialog||(showInfoDialog(IDS_wps_connection),g_hasPopInfoDialog=!0),button_enable("button_connection","0"))})),pbcOffloadTimer=setTimeout(find_wifi_offload_status,PBC_GET_STATUS_INTERVAL)}function stationwps_pbc_connect_status(){getAjaxData("api/wlan/wps-pbc",(function(t){var o=xml2object(t);if(PBC_CONNECT_FAILED==o.response.State)closeWaitingDialog(),g_hasWaitingDialog=!1,clearTimeout(pbcWaitingTimer),button_enable("button_connection","0"),startLogoutTimer(),showInfoDialog(pbc_label_connect_failed);else{if(PBC_CONNECT_SUCCESS!=o.response.State)return void(pbcGetStatusTimer=setTimeout(stationwps_pbc_connect_status,PBC_GET_STATUS_INTERVAL));closeWaitingDialog(),g_hasWaitingDialog=!1,clearTimeout(pbcWaitingTimer),button_enable("button_connection","0"),startLogoutTimer(),showInfoDialog(pbc_label_connect_success)}}))}function savestationwpsPbc(){var t=object2xml("request",{WPSMode:"3"});button_enable("button_connection","0"),saveAjaxData("api/wlan/wps-pbc",t,(function(t){var o=xml2object(t);isAjaxReturnOK(o)?(g_hasWaitingDialog=!0,showWaitingDialog(common_waiting,pbc_label_connecting_network),pbcWaitingTimer=setTimeout((function(){closeWaitingDialog(),g_hasWaitingDialog=!1,startLogoutTimer(),clearTimeout(pbcGetStatusTimer),showInfoDialog(pbc_label_connect_failed),startLogoutTimer()}),PBC_WAITING_TIMEOUT),pbcGetStatusTimer=setTimeout(stationwps_pbc_connect_status,PBC_GET_STATUS_INTERVAL)):o.error.code==ERROR_SYSTEM_BUSY?showInfoDialog(common_system_busy):showInfoDialog(pbc_label_connect_failed)}))}$(document).ready((function(){find_wifi_offload_status(),$("#button_connection").click((function(){if(isButtonEnable("button_connection"))return button_enable("button_connection","0"),showConfirmDialog(IDS_system_hint_connection,savestationwpsPbc,(function(){})),!1}))}));
